import{j as e,d as k,Q as J,R as G,B as A,V as q,W as $,X as _,Y as w,r as p,_ as Q,a7 as X,a5 as P,bl as Y,C as v,aB as M,aC as F,aD as S,aE as y,a2 as Z,aJ as R,aK as ee,aL as C,aM as D,aN as O,aO as T,H as se,p as ae,T as te,q as le,M as ne,aI as E,c as ie}from"./index-Dwd0asRO.js";import{A as H,a as U,C as re,E as ce}from"./react-icons.esm-B5IdiUXk.js";import{T as f,d as g,b as x,e as d,u as de,l as oe,a as K,c as m,f as L}from"./table-Bj013E3s.js";import{D as he,a as xe,J as me,R as je}from"./main-CigzAjzx.js";function V({column:s,title:r,className:t}){return s.getCanSort()?e.jsx("div",{className:k("flex items-center space-x-2",t),children:e.jsxs(J,{children:[e.jsx(G,{asChild:!0,children:e.jsxs(A,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:r}),s.getIsSorted()==="desc"?e.jsx(H,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(U,{className:"ml-2 h-4 w-4"}):e.jsx(re,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(q,{align:"start",children:[e.jsxs($,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(U,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs($,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(H,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),s.getCanHide()&&e.jsxs(e.Fragment,{children:[e.jsx(_,{}),e.jsxs($,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(ce,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})]})}):e.jsx("div",{className:k(t),children:r})}const W=p.createContext(null);function ue({children:s}){const[r,t]=w.useState(null),[a,l]=w.useState(null),[n,i]=w.useState(void 0);return e.jsx(W.Provider,{value:{open:r,setOpen:t,currentRow:a,setCurrentRow:l,nodeName:n,setNodeName:i},children:s})}const z=()=>{const s=p.useContext(W);if(!s)throw new Error("useNodes must be used within a NodesProvider");return s},pe=[{id:"status",header:"状态",cell:({row:s})=>{var c,h;const r=((h=(c=s.original)==null?void 0:c.status)==null?void 0:h.conditions)||[],t=r.find(o=>o.type==="Ready"),a=r.filter(o=>o.type!=="Ready").every(o=>o.status==="False"),l=t&&t.status==="True"||a?"Active":"警告",n=t&&t.status==="True"||a?"green":"red",i=r.filter(o=>o.type==="Ready"&&o.status==="False"||o.type!=="Ready"&&o.status==="True").map(o=>o.message).join(`
`);return e.jsx("span",{style:{color:n},title:i,children:l})}},{id:"name",header:({column:s})=>e.jsx(V,{column:s,title:"节点名称"}),cell:({row:s})=>{var n,i;const{setOpen:r,setCurrentRow:t}=z(),a=()=>{r("detail"),t(s.original)},l=((i=(n=s.original)==null?void 0:n.metadata)==null?void 0:i.labels)||{};return Object.keys(l).filter(c=>c.startsWith("node-role.kubernetes.io/")).map(c=>c.replace("node-role.kubernetes.io/","")).join(", "),e.jsx("div",{children:e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap hover:overflow-visible text-blue-500 hover:text-blue-600 cursor-pointer",onClick:a,children:s.original.metadata.name})})},enableSorting:!1,enableHiding:!1},{id:"roles",header:({column:s})=>e.jsx(V,{column:s,title:"角色"}),cell:({row:s})=>{var a,l;const r=((l=(a=s.original)==null?void 0:a.metadata)==null?void 0:l.labels)||{},t=Object.keys(r).filter(n=>n.startsWith("node-role.kubernetes.io/")).map(n=>n.replace("node-role.kubernetes.io/","")).map(n=>e.jsx(Q,{className:"ml-1 bg-green-600",children:n},n));return e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap hover:overflow-visible flex items-center",children:t.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:t}):"-"})},enableSorting:!0,enableHiding:!1},{id:"Kubernetes",header:"Kubernetes",cell:({row:s})=>{var t,a,l;return((l=(a=(t=s.original)==null?void 0:t.status)==null?void 0:a.nodeInfo)==null?void 0:l.kubeletVersion)||"N/A"}},{id:"cpu",header:"CPU核数",cell:({row:s})=>{var t,a,l;return((l=(a=(t=s.original)==null?void 0:t.status)==null?void 0:a.allocatable)==null?void 0:l.cpu)||"N/A"}},{id:"memory",header:"内存容量",cell:({row:s})=>{var l,n,i;const r=(i=(n=(l=s.original)==null?void 0:l.status)==null?void 0:n.capacity)==null?void 0:i.memory;return(c=>{if(!c)return"0";if(c.endsWith("Ki")){let h=parseFloat(c);if(h>1024){let o=h/1024;return o>1024?`${(o/1024).toFixed(0)} Gi`:`${o.toFixed(0)} Mi`}else return`${h.toFixed(0)} Ki`}if(c.endsWith("Mi")){let h=parseFloat(c);return h>1024?`${(h/1024).toFixed(0)} Gi`:`${h.toFixed(0)} Mi`}return c})(r)||"N/A"}},{accessorKey:"pods",header:"Pod数量",cell:({row:s})=>{var t,a,l;return((l=(a=(t=s.original)==null?void 0:t.status)==null?void 0:a.allocatable)==null?void 0:l.pods)||"N/A"}},{accessorKey:"creationTimestamp",header:"运行时间",cell:({row:s})=>{var c;const r=(c=s.original.metadata)==null?void 0:c.creationTimestamp;if(!r)return"N/A";const t=Date.now()-new Date(r).getTime(),a=Math.floor(t/1e3),l=Math.floor(a/60),n=Math.floor(l/60),i=Math.floor(n/24);return i>0?`${i}d`:n>0?`${n}h`:l>0?`${l}m`:`${a}s`}},{id:"ip",header:"IP地址",cell:({row:s})=>{var t,a,l;return(((l=(a=(t=s.original)==null?void 0:t.status)==null?void 0:a.addresses)==null?void 0:l.filter(n=>n.type==="InternalIP"))||[]).map(n=>e.jsx(X,{className:"text-blue-600",children:n.address},n.type))}},{accessorKey:"cpuUsage",header:"CPU使用率",cell:({row:s})=>{var r,t,a,l,n;try{const i=(a=(t=(r=s.original)==null?void 0:r.status)==null?void 0:t.allocatable)==null?void 0:a.cpu,c=(l=s.original)==null?void 0:l.metrics,h=(n=c==null?void 0:c.usage)==null?void 0:n.cpu,o=b=>b?b.endsWith("m")?parseFloat(b)/1e3:b.endsWith("n")?parseFloat(b)/1e9:parseFloat(b):0,u=o(i),j=o(h),N=u&&j?j/u*100:null;return N?e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"w-full h-6 rounded-full border border-gray-200 bg-gray-100 overflow-hidden relative",children:[e.jsx("div",{className:`h-full transition-all duration-300 absolute top-0 left-0 ${N<30?"bg-green-400":N<60?"bg-yellow-400":N<80?"bg-orange-400":"bg-red-500"}`,style:{width:`${N}%`}}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-gray-800 z-10",children:[N.toFixed(2),"%"]})]})}):"N/A"}catch(i){P({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(i,null,2)})})})}}},{accessorKey:"memoryUsage",header:"内存使用率",cell:({row:s})=>{var r,t,a;try{const l=(t=(r=s.original.status)==null?void 0:r.allocatable)==null?void 0:t.memory,n=s.original.metrics,i=(a=n==null?void 0:n.usage)==null?void 0:a.memory,c=j=>j?j.endsWith("Ki")?parseFloat(j)*1024:j.endsWith("Mi")?parseFloat(j)*1024*1024:j.endsWith("Gi")?parseFloat(j)*1024*1024*1024:parseFloat(j):0,h=c(l),o=c(i),u=h&&o?o/h*100:null;return u?e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"w-full h-6 rounded-full border border-gray-200 bg-gray-100 overflow-hidden relative",children:[e.jsx("div",{className:`h-full transition-all duration-300 absolute top-0 left-0 ${u<30?"bg-green-400":u<60?"bg-yellow-400":u<80?"bg-orange-400":"bg-red-500"}`,style:{width:`${u}%`}}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-gray-800 z-10",children:[u.toFixed(2),"%"]})]})}):"N/A"}catch(l){P({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(l,null,2)})})})}}}];function fe({columns:s,data:r}){var a;if(!s||!r)return e.jsx("div",{className:"rounded-md border",children:e.jsx(f,{children:e.jsx(g,{children:e.jsx(x,{children:e.jsx(d,{colSpan:(s==null?void 0:s.length)||0,className:"h-24 text-center",children:"没有数据"})})})})});const t=de({data:r,columns:s,getCoreRowModel:oe()});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(f,{children:[e.jsx(K,{children:t.getHeaderGroups().map(l=>e.jsx(x,{children:l.headers.map(n=>e.jsx(m,{children:n.isPlaceholder?null:L(n.column.columnDef.header,n.getContext())},n.id))},l.id))}),e.jsx(g,{children:(a=t.getRowModel().rows)!=null&&a.length?t.getRowModel().rows.map(l=>e.jsx(x,{"data-state":l.getIsSelected()&&"selected",children:l.getVisibleCells().map(n=>e.jsx(d,{children:L(n.column.columnDef.cell,n.getContext())},n.id))},l.id)):e.jsx(x,{children:e.jsx(d,{colSpan:s.length,className:"h-24 text-center",children:"没有数据"})})})]})})}function ge({columns:s,data:r}){return e.jsx(fe,{columns:s,data:r})}function Ne(){return e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(A,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"添加节点"]})})}function be({currentRow:s}){const r=p.useMemo(()=>!s||!s.metadata.labels?[]:Object.entries(s.metadata.labels).map(([t,a])=>e.jsxs(x,{children:[e.jsx(d,{className:"font-medium",children:t}),e.jsx(d,{children:a})]},t)),[s]);return e.jsxs(v,{children:[e.jsxs(M,{children:[e.jsx(F,{children:"Labels"}),e.jsx(S,{children:"Labels是Kubernetes中用于标识资源的字段。它们通常用于标识资源的类型、状态、版本等。 Labels可以是任意的键值对，它们可以用于标识资源的类型、状态、版本等。 Labels通常用于标识资源的类型、状态、版本等。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsx(f,{children:e.jsx(g,{children:r})})})]})}function ve({currentRow:s}){const r=p.useMemo(()=>!s||!s.metadata.annotations?[]:Object.entries(s.metadata.annotations).map(([t,a])=>e.jsxs(x,{children:[e.jsx(d,{className:"font-medium",children:t}),e.jsx(d,{children:a})]},t)),[s]);return e.jsxs(v,{children:[e.jsxs(M,{children:[e.jsx(F,{children:"Annotations"}),e.jsx(S,{children:"Annotations是Kubernetes中用于存储元数据的字段。它们通常用于存储额外的信息，例如描述、标签等。 Annotations可以是任意的键值对，它们可以用于存储任何类型的信息，例如描述、标签、版本等。 Annotations通常用于存储元数据，例如描述、标签、版本等。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsx(f,{children:e.jsx(g,{children:r})})})]})}function ye({currentRow:s}){const r=p.useMemo(()=>{var t,a;return!s||!((t=s.status)!=null&&t.images)?[]:Object.entries(((a=s.status)==null?void 0:a.images)||{}).map(([l,n])=>e.jsxs(x,{children:[n.names&&e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"max-w-[40vw] overflow-hidden whitespace-nowrap text-ellipsis hover:overflow-visible hover:whitespace-normal",children:n.names[0]}),e.jsx(d,{className:"max-w-[40vw] overflow-hidden whitespace-nowrap text-ellipsis hover:overflow-visible hover:whitespace-normal",children:n.names.length>1?n.names[1]:""})]}),e.jsx(d,{children:function(){const i=n.sizeBytes;return i<1024?`${i} B`:i<1048576?`${(i/1024).toFixed(2)} KB`:i<1073741824?`${(i/1048576).toFixed(2)} MB`:`${(i/1073741824).toFixed(2)} GB`}()})]},l||Math.random()))},[s]);return e.jsx(e.Fragment,{children:e.jsxs(v,{className:"mt-4",children:[e.jsxs(M,{children:[e.jsx(F,{children:"节点镜像"}),e.jsx(S,{children:"节点镜像是指节点上运行的镜像。这些镜像包含了节点的操作系统、运行时和应用程序。 节点镜像通常是由Kubernetes管理的，Kubernetes会自动下载和管理这些镜像。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsxs(f,{className:"max-h-[300px] overflow-y-auto",children:[e.jsx(K,{children:e.jsxs(x,{children:[e.jsx(m,{children:"Hash"}),e.jsx(m,{children:"镜像"}),e.jsx(m,{className:"w-[10vh]",children:"大小"})]})}),e.jsx(g,{children:r})]})})]})})}function Ce({currentRow:s}){const r=p.useMemo(()=>{var a,l,n;if(!s)return[];let t=[];return s.spec&&(t=t.concat(Object.entries(s.spec).map(([i,c])=>e.jsxs(x,{children:[e.jsxs(d,{className:"font-medium",children:["spec.",i]}),e.jsx(d,{children:i==="taints"?JSON.stringify(c):String(c)})]},`spec-${i}`)))),(a=s.status)!=null&&a.addresses&&(t=t.concat(s.status.addresses.map((i,c)=>e.jsxs(x,{children:[e.jsxs(d,{className:"font-medium",children:["status.addresses[",c,"].",i.type]}),e.jsx(d,{children:String(i.address)})]},`address-${c}`)))),(l=s.status)!=null&&l.daemonEndpoints&&(t=t.concat(Object.entries(s.status.daemonEndpoints).map(([i,c])=>e.jsxs(x,{children:[e.jsxs(d,{className:"font-medium",children:["status.daemonEndpoints.",i]}),e.jsx(d,{children:String(c.Port)})]},`daemonEndpoints-${i}`)))),(n=s.status)!=null&&n.nodeInfo&&(t=t.concat(Object.entries(s.status.nodeInfo).map(([i,c])=>e.jsxs(x,{children:[e.jsx(d,{className:"font-medium",children:i}),e.jsx(d,{children:String(c)})]},i)))),t},[s]);return e.jsx(e.Fragment,{children:e.jsxs(v,{className:"mt-4",children:[e.jsxs(M,{children:[e.jsx(F,{children:"节点信息"}),e.jsx(S,{children:"节点信息是Kubernetes中用于描述节点的字段。它们通常用于标识节点的类型、状态、版本等。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsx(f,{className:"max-h-[300px] overflow-y-auto",children:e.jsx(g,{children:r})})})]})})}function Te({currentRow:s}){var a;const r=p.useMemo(()=>{var l;return!s||!((l=s.status)!=null&&l.conditions)?[]:Object.entries(s.status.conditions).map(([n,i])=>e.jsxs(x,{children:[e.jsx(d,{children:i.type}),e.jsx(d,{className:`font-medium ${i.status==="True"?"text-green-500":"text-red-500"}`,children:i.status}),e.jsx(d,{children:i.reason}),e.jsx(d,{children:i.message}),e.jsx(d,{children:new Date(i.lastHeartbeatTime).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),e.jsx(d,{children:new Date(i.lastTransitionTime).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]},n))},[s]),t=p.useMemo(()=>!s||!s.spec.taints?[]:Object.entries(s.spec.taints).map(([l,n])=>e.jsxs(x,{children:[e.jsx(d,{className:"text-red-500",children:n.effect}),e.jsx(d,{children:n.key}),e.jsx(d,{children:n.value})]},l)),[s]);return e.jsxs(e.Fragment,{children:[e.jsxs(v,{className:"mt-4",children:[e.jsxs(M,{children:[e.jsx(F,{children:"Conditions"}),e.jsx(S,{children:"Conditions是Kubernetes中用于描述节点或Pod状态的字段。它们通常用于指示节点或Pod是否正常运行，以及是否有任何问题需要注意。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsxs(f,{className:"max-h-[300px] overflow-y-auto",children:[e.jsx(K,{children:e.jsxs(x,{children:[e.jsx(m,{children:"类型"}),e.jsx(m,{children:"状态"}),e.jsx(m,{children:"原因"}),e.jsx(m,{children:"消息"}),e.jsx(m,{children:"最近一次心跳"}),e.jsx(m,{children:"最近一次通信"})]})}),e.jsx(g,{children:r})]})})]}),((a=s==null?void 0:s.spec)==null?void 0:a.taints)&&e.jsxs(v,{className:"mt-4",children:[e.jsxs(M,{children:[e.jsx(F,{children:"污点"}),e.jsx(S,{children:"Taints是Kubernetes中的一个概念，用于标记节点或Pod，以防止它们被调度到不合适的节点上。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsxs(f,{className:"max-h-[300px] overflow-y-auto",children:[e.jsx(K,{children:e.jsxs(x,{children:[e.jsx(m,{children:"Effect"}),e.jsx(m,{children:"Key"}),e.jsx(m,{children:"Value"})]})}),e.jsx(g,{children:t})]})})]})]})}function Me({currentRow:s}){var t;const r=p.useMemo(()=>!s||!s.spec.taints?[]:Object.entries(s.spec.taints).map(([a,l])=>e.jsxs(x,{children:[e.jsx(d,{className:"text-red-500",children:l.effect}),e.jsx(d,{children:l.key}),e.jsx(d,{children:l.value})]},a)),[s]);return e.jsx(e.Fragment,{children:((t=s==null?void 0:s.spec)==null?void 0:t.taints)&&e.jsxs(v,{className:"mt-4",children:[e.jsxs(M,{children:[e.jsx(F,{children:"污点"}),e.jsx(S,{children:"Taints是Kubernetes中的一个概念，用于标记节点或Pod，以防止它们被调度到不合适的节点上。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsxs(f,{className:"max-h-[300px] overflow-y-auto",children:[e.jsx(K,{children:e.jsxs(x,{children:[e.jsx(m,{children:"Effect"}),e.jsx(m,{children:"Key"}),e.jsx(m,{children:"Value"})]})}),e.jsx(g,{children:r})]})})]})})}function Fe({currentRow:s}){const r=(a,l)=>{if(l==="cpu"||l==="pods"||l==="hugepages-1Gi"||l==="hugepages-2Mi"||l==="ephemeral-storage")return String(a);if(typeof a!="number"){if(typeof a=="string"){const c=a.match(/(\d+)([a-zA-Z]+)/);if(c){const h=parseInt(c[1],10);switch(c[2]){case"Ki":a=h*1024;break;case"Mi":a=h*1024*1024;break;case"Gi":a=h*1024*1024*1024;break;default:return"N/A"}}else return"N/A"}}const n=["B","KB","MB","GB"];let i=0;for(;a>=1024&&i<n.length-1;)a/=1024,i++;return`${a.toFixed(2)} ${n[i]}`},t=p.useMemo(()=>{var l,n;if(!s||!((l=s.status)!=null&&l.allocatable)||!((n=s.status)!=null&&n.capacity))return[];const a=new Set([...Object.keys(s.status.allocatable),...Object.keys(s.status.capacity)]);return Array.from(a).map(i=>{const c=s.status.allocatable[i]||0,h=s.status.capacity[i]||0;return e.jsxs(x,{children:[e.jsx(d,{className:"font-medium",children:i}),e.jsx(d,{children:r(c,i)}),e.jsx(d,{children:r(h,i)})]},`combined-${i}`)})},[s]);return e.jsx(e.Fragment,{children:e.jsxs(v,{className:"mt-4",children:[e.jsxs(M,{children:[e.jsx(F,{children:"节点信息"}),e.jsx(S,{children:"节点信息是Kubernetes中用于描述节点的字段。它们通常用于标识节点的类型、状态、版本等。"})]}),e.jsx(y,{className:"space-y-2",children:e.jsxs(f,{className:"max-h-[300px] overflow-y-auto",children:[e.jsx(K,{children:e.jsxs(x,{children:[e.jsx(m,{children:"类型"}),e.jsx(m,{children:"可分配"}),e.jsx(m,{children:"容量"})]})}),e.jsx(g,{children:t})]})})]})})}function Se({open:s,onOpenChange:r,nodeName:t,currentRow:a}){var l,n,i,c,h,o,u,j,N,b,I,B;return e.jsx(he,{open:s,onOpenChange:r,children:e.jsxs(xe,{className:"h-[80vh] mt-0",children:[e.jsxs(Z,{className:"flex justify-center items-center mb-5",children:[t," 节点详情"]}),e.jsx("div",{className:"w-full h-full",children:e.jsxs(R,{defaultValue:"nodeinfo",className:"w-full",children:[e.jsxs(ee,{className:"grid w-full grid-cols-8 gap-2",children:[e.jsxs(C,{value:"nodeinfo",children:["节点信息",e.jsx(D,{className:"h-5 w-5 ml-1",children:e.jsx(O,{className:"text-xs",children:(l=a==null?void 0:a.status)!=null&&l.nodeInfo?Object.keys((n=a.status)==null?void 0:n.nodeInfo).length:0})})]}),e.jsxs(C,{value:"capacity",children:["容量",e.jsx(D,{className:"h-5 w-5 ml-1",children:e.jsx(O,{className:"text-xs",children:(i=a==null?void 0:a.status)!=null&&i.capacity?Object.keys((c=a.status)==null?void 0:c.capacity).length:0})})]}),e.jsxs(C,{value:"labels",children:["标签",e.jsx(D,{className:"h-5 w-5 ml-1",children:e.jsx(O,{className:"text-xs",children:(h=a==null?void 0:a.metadata)!=null&&h.labels?Object.keys(a.metadata.labels).length:0})})]}),e.jsxs(C,{value:"annotations",children:["注释",e.jsx(D,{className:"h-5 w-5 ml-1",children:e.jsx(O,{className:"text-xs",children:(o=a==null?void 0:a.metadata)!=null&&o.annotations?Object.keys(a.metadata.annotations).length:0})})]}),e.jsxs(C,{value:"conditions",children:["告警",e.jsx(D,{className:"h-5 w-5 ml-1",children:e.jsx(O,{className:"text-xs",children:(u=a==null?void 0:a.status)!=null&&u.conditions?Object.keys((j=a.status)==null?void 0:j.conditions).length:0})})]}),e.jsxs(C,{value:"taints",children:["污点",e.jsx(D,{className:"h-5 w-5 ml-1",children:e.jsx(O,{className:"text-xs",children:(N=a==null?void 0:a.spec)!=null&&N.taints?Object.keys((b=a.spec)==null?void 0:b.taints).length:0})})]}),e.jsxs(C,{value:"images",children:["镜像",e.jsx(D,{className:"h-5 w-5 ml-1",children:e.jsx(O,{className:"text-xs",children:(I=a==null?void 0:a.status)!=null&&I.images?Object.keys((B=a.status)==null?void 0:B.images).length:0})})]}),e.jsx(C,{value:"rawdata",children:"原始JSON"})]}),e.jsx(T,{value:"nodeinfo",className:"h-[80vh] overflow-y-auto",children:e.jsx(Ce,{currentRow:a})}),e.jsx(T,{value:"capacity",className:"h-[80vh] overflow-y-auto",children:e.jsx(Fe,{currentRow:a})}),e.jsx(T,{value:"labels",className:"h-[80vh] overflow-y-auto",children:e.jsx(be,{currentRow:a})}),e.jsx(T,{value:"annotations",className:"h-[80vh] overflow-y-auto",children:e.jsx(ve,{currentRow:a})}),e.jsx(T,{value:"images",className:"h-[80vh] overflow-y-auto",children:e.jsx(ye,{currentRow:a})}),e.jsx(T,{value:"conditions",className:"h-[80vh] overflow-y-auto",children:e.jsx(Te,{currentRow:a})}),e.jsx(T,{value:"taints",className:"h-[80vh] overflow-y-auto",children:e.jsx(Me,{currentRow:a})}),e.jsx(T,{value:"rawdata",className:"h-[80vh] overflow-y-auto",children:e.jsx(v,{children:e.jsx(y,{className:"space-y-2",children:e.jsx("div",{className:"flex justify-start mb-4",children:e.jsx(me,{src:a||{},enableClipboard:!0,displayDataTypes:!1,name:!1})})})})})]})})]})})}function De(){const{open:s,setOpen:r,currentRow:t,setCurrentRow:a,setNodeName:l}=z();return e.jsx(e.Fragment,{children:t&&e.jsx(Se,{open:s==="detail",onOpenChange:()=>{r(null),l(void 0),setTimeout(()=>{a(null)},500)},nodeName:t==null?void 0:t.metadata.name,currentRow:t},"node-detail")})}function Oe(){const[s,r]=p.useState([]),t=async()=>{try{const a=await E.post("/api/gvr/list",{group:"",version:"v1",resource:"nodes",namespace:""});r(a.data.items);const l=await E.get("/api/monitor/metrics/node"),n=a.data.items.map(i=>({...i,metrics:l.data.items.find(c=>c.metadata.name===i.metadata.name)}));r(n),console.log("请求接口成功 metrics:",n)}catch(a){P({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(a,null,2)})})})}};return p.useEffect(()=>{t()},[]),e.jsxs(ue,{children:[e.jsxs(se,{fixed:!0,children:[e.jsx(ae,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(te,{}),e.jsx(le,{})]})]}),e.jsxs(ne,{children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-x-4 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Kubernetes Nodes"}),e.jsx("p",{className:"text-muted-foreground",children:"查看和管理您的Kubernetes集群节点信息"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{}),e.jsxs(A,{variant:"outline",size:"sm",onClick:t,children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"刷新"]})]})]}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(ge,{data:s,columns:pe})})]}),e.jsx(De,{})]})}const Ae=ie("/_authenticated/nodes/")({component:Oe});export{Ae as Route};
