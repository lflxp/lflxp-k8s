import{j as e,d as ee,Q as ne,R as ge,B as v,V as le,W as R,X as Ne,Y as be,r as N,z as i,Z as Le,_ as J,D as ve,E as ye,J as Se,K as Ce,ag as Ue,ah as Ve,ai as ze,s as qe,a9 as Ge,aa as Ke,ab as We,ac as Ye,ad as oe,ae as ce,af as Be,I as Y,b as Ze,t as Qe,$ as Xe,a0 as we,a1 as Re,a2 as es,a3 as ss,F as as,e as ts,f as is,g as ns,h as ls,i as rs,a4 as ds,a8 as os,a5 as y,av as cs,aw as me,C,ax as T,ay as k,az as A,aA as _,a7 as se,aB as K,ao as De,ap as Te,aq as ke,ar as Ae,as as Pe,at as _e,au as Ee,aC as Q,aD as ms,aE as V,aF as ae,aG as hs,aH as xs,aI as G,aJ as X,aK as w,aL as $,H as ps,p as js,T as us,q as fs,M as gs,c as Ns}from"./index-Sj8PalxT.js";import{C as he}from"./checkbox-BjU778Mu.js";import{A as xe,a as pe,C as bs,E as vs,D as ys,b as Ss,c as Cs,d as Ds,e as Ts,M as ks,P as As,f as Ps,g as _s}from"./react-icons.esm-CmOjNWrw.js";import{u as Es,I as Is,C as Ms}from"./confirm-dialog-3ingpBbi.js";import{u as Os,T as E,a as I,b as p,c as x,f as je,d as M,e as l,g as Hs,h as Fs,i as Js,j as $s,k as Ls,l as Us,m as Vs}from"./table-Y-QFyalC.js";import{S as Ie,a as Me,b as Oe,c as He,d as W}from"./select-CMBpdrj9.js";import{P as zs,a as qs,b as Gs}from"./popover-CKBiPf50.js";import{I as Ks}from"./IconDownload-DIp14WRt.js";import{I as Ws}from"./IconPlus-DmtLbeXb.js";import{T as te}from"./textarea-Du6n_54Z.js";import{D as re,a as de}from"./drawer-BexXwk-V.js";import{C as Ys}from"./chart-CX5WESNy.js";import{J as Fe}from"./main-ugSn7wM5.js";import{I as U,a as ue,M as ie}from"./IconTrendingUp-DtRTf-xr.js";import{R as Bs}from"./refresh-cw-CZoVMONF.js";import"./index-CcR2qwFx.js";function H({column:s,title:n,className:a}){return s.getCanSort()?e.jsx("div",{className:ee("flex items-center space-x-2",a),children:e.jsxs(ne,{children:[e.jsx(ge,{asChild:!0,children:e.jsxs(v,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:n}),s.getIsSorted()==="desc"?e.jsx(xe,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(pe,{className:"ml-2 h-4 w-4"}):e.jsx(bs,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(le,{align:"start",children:[e.jsxs(R,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(pe,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(R,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(xe,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),s.getCanHide()&&e.jsxs(e.Fragment,{children:[e.jsx(Ne,{}),e.jsxs(R,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(vs,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})]})}):e.jsx("div",{className:ee(a),children:n})}const Je=be.createContext(null);function Zs({children:s}){const[n,a]=Es(null),[t,r]=N.useState(null),[d,c]=N.useState(void 0);return e.jsx(Je,{value:{open:n,setOpen:a,currentRow:t,setCurrentRow:r,containerName:d,setContainerName:c},children:s})}const q=()=>{const s=be.useContext(Je);if(!s)throw new Error("useTasks has to be used within <PodsContext>");return s},Qs=i.object({apiVersion:i.string(),kind:i.string(),metadata:i.object({name:i.string(),namespace:i.string().optional(),labels:i.record(i.string(),i.string()).optional(),annotations:i.record(i.string(),i.string()).optional(),creationTimestamp:i.string().optional(),resourceVersion:i.string().optional(),uid:i.string().optional()}).optional(),spec:i.object({replicas:i.number().optional(),selector:i.object({matchLabels:i.record(i.string(),i.string()).optional(),matchExpressions:i.array(i.object({key:i.string(),operator:i.enum(["In","NotIn","Exists","DoesNotExist"]),values:i.array(i.string()).optional()})).optional()}).optional(),template:i.object({metadata:i.object({labels:i.record(i.string(),i.string()).optional(),annotations:i.record(i.string(),i.string()).optional()}).optional(),spec:i.object({containers:i.array(i.object({name:i.string(),image:i.string(),ports:i.array(i.object({containerPort:i.number(),protocol:i.string().optional()})).optional(),env:i.array(i.object({name:i.string(),value:i.string().optional(),valueFrom:i.object({fieldRef:i.object({fieldPath:i.string()}).optional(),secretKeyRef:i.object({name:i.string(),key:i.string()}).optional(),configMapKeyRef:i.object({name:i.string(),key:i.string()}).optional()}).optional()})).optional(),resources:i.object({limits:i.record(i.string(),i.string()).optional(),requests:i.record(i.string(),i.string()).optional()}).optional()})),restartPolicy:i.string().optional(),nodeSelector:i.record(i.string(),i.string()).optional(),serviceAccountName:i.string().optional(),affinity:i.object({nodeAffinity:i.object({requiredDuringSchedulingIgnoredDuringExecution:i.object({nodeSelectorTerms:i.array(i.object({matchExpressions:i.array(i.object({key:i.string(),operator:i.enum(["In","NotIn","Exists","DoesNotExist","Gt","Lt"]),values:i.array(i.string()).optional()}))}))}).optional()}).optional()}).optional()}).optional()}).optional()}).optional(),status:i.object({currentNumberScheduled:i.number().optional(),numberMisscheduled:i.number().optional(),desiredNumberScheduled:i.number().optional(),numberReady:i.number().optional(),numberUnavailable:i.number().optional(),numberAvailable:i.number().optional(),conditions:i.array(i.object({type:i.string(),status:i.string(),lastUpdateTime:i.string().optional(),lastTransitionTime:i.string().optional(),reason:i.string().optional(),message:i.string().optional()})).optional(),collisionCount:i.number().optional(),observedGeneration:i.number().optional(),updatedNumberScheduled:i.number().optional()}).optional()}),Xs=i.object({name:i.string(),namespace:i.string(),crd:Qs,status:i.object({currentNumberScheduled:i.number().optional(),numberMisscheduled:i.number().optional(),desiredNumberScheduled:i.number().optional(),numberReady:i.number().optional(),numberUnavailable:i.number().optional(),numberAvailable:i.number().optional(),conditions:i.array(i.object({type:i.string(),status:i.string(),lastUpdateTime:i.string().optional(),lastTransitionTime:i.string().optional(),reason:i.string().optional(),message:i.string().optional()})).optional(),collisionCount:i.number().optional(),observedGeneration:i.number().optional(),updatedNumberScheduled:i.number().optional()}).optional()});function ws({row:s}){const n=Xs.parse(s.original),{setOpen:a,setCurrentRow:t}=q();return e.jsxs(ne,{modal:!1,children:[e.jsx(ge,{asChild:!0,children:e.jsxs(v,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(ys,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsx(le,{align:"end",className:"w-[160px]",children:e.jsxs(R,{onClick:()=>{t(n),a("delete")},children:["刪除",e.jsx(Le,{children:e.jsx(Is,{size:16})})]})})]})}const Rs=[{id:"select",header:({table:s})=>e.jsx(he,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:n=>s.toggleAllPageRowsSelected(!!n),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(he,{checked:s.getIsSelected(),onCheckedChange:n=>s.toggleSelected(!!n),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"active",header:({column:s})=>e.jsx(H,{column:s,title:"状态"}),cell:({row:s})=>{var a,t,r,d,c,o;return(t=(a=s.original)==null?void 0:a.status)!=null&&t.numberReady?((d=(r=s.original)==null?void 0:r.status)==null?void 0:d.desiredNumberScheduled)===((o=(c=s.original)==null?void 0:c.status)==null?void 0:o.numberReady)?e.jsx(J,{variant:"outline",className:"text-green-500 border-none",children:"Running"}):e.jsx(J,{variant:"outline",className:"text-red-500 border-none",children:"Progressing"}):e.jsx(J,{variant:"outline",className:"text-red-500 border-none",children:"Progressing"})},enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:s})=>e.jsx(H,{column:s,title:"名称"}),cell:({row:s})=>{var r;const{setOpen:n,setCurrentRow:a}=q(),t=()=>{n("detail"),a(s.original)};return e.jsx("div",{children:e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap hover:overflow-visible hover:text-blue-600 cursor-pointer",onClick:t,children:(r=s.original)==null?void 0:r.name})})},enableSorting:!1,enableHiding:!1},{accessorKey:"namespace",header:({column:s})=>e.jsx(H,{column:s,title:"命名空间"}),cell:({row:s})=>{var n;return e.jsx("div",{className:"w-fit",children:(n=s.original)==null?void 0:n.namespace})}},{accessorKey:"images",header:({column:s})=>e.jsx(H,{column:s,title:"镜像"}),cell:({row:s})=>{var t,r,d,c,o;const a=(((o=(c=(d=(r=(t=s.original)==null?void 0:t.crd)==null?void 0:r.spec)==null?void 0:d.template)==null?void 0:c.spec)==null?void 0:o.containers)||[]).map(h=>h.image);return a.length===0?e.jsx("div",{children:"-"}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(ve,{children:e.jsxs(ye,{children:[e.jsx(Se,{children:e.jsx("div",{className:"max-w-[200px] truncate",children:a[0]})}),e.jsx(Ce,{className:"max-w-[400px] whitespace-pre-wrap",children:a.map((h,f)=>e.jsx("div",{children:h},f))})]})}),a.length>1&&e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground",children:["+",a.length-1," more"]})]})},enableHiding:!0},{accessorKey:"desired",header:({column:s})=>e.jsx(H,{column:s,title:"DESIRED"}),cell:({row:s})=>{var n,a;return((a=(n=s.original)==null?void 0:n.status)==null?void 0:a.desiredNumberScheduled)||0}},{accessorKey:"current",header:({column:s})=>e.jsx(H,{column:s,title:"CURRENT"}),cell:({row:s})=>{var n;return((n=s.original.status)==null?void 0:n.currentNumberScheduled)||0}},{accessorKey:"ready",header:({column:s})=>e.jsx(H,{column:s,title:"READY"}),cell:({row:s})=>{var n;return((n=s.original.status)==null?void 0:n.numberReady)||0}},{accessorKey:"uptodate",header:({column:s})=>e.jsx(H,{column:s,title:"UP TO DATE"}),cell:({row:s})=>{var n;return((n=s.original.status)==null?void 0:n.updatedNumberScheduled)||0}},{accessorKey:"avaliable",header:({column:s})=>e.jsx(H,{column:s,title:"AVALIABLE"}),cell:({row:s})=>{var n;return((n=s.original.status)==null?void 0:n.numberAvailable)||0},enableSorting:!0,enableHiding:!1},{accessorKey:"selector",header:({column:s})=>e.jsx(H,{column:s,title:"NODE SELECTOR"}),cell:({row:s})=>{var n,a,t;return(t=(a=(n=s.original)==null?void 0:n.crd)==null?void 0:a.spec)!=null&&t.template.spec.nodeSelector?Object.entries(s.original.crd.spec.template.spec.nodeSelector).map(([r,d])=>`${r}=${d}`):"-"},enableSorting:!1,enableHiding:!1},{accessorKey:"createtime",header:({column:s})=>e.jsx(H,{column:s,title:"运行时间"}),cell:({row:s})=>{var f;const n=m=>{const u=Date.now()-m,b=24*3600*1e3,g=3600*1e3,S=60*1e3,P=Math.floor(u/b),D=u%b,F=Math.floor(D/g),O=D%g,B=Math.floor(O/S),Z=O%S,L=Math.round(Z/1e3);return{days:P,hours:F,minutes:B,seconds:L}},a=(m,j,u,b)=>{let g="";return m>0&&(g+=`${m}d `),j>0&&(g+=`${j}h `),u>0&&(g+=`${u}m `),b>0&&(g+=`${b}s`),g},t=new Date(((f=s.original.crd.metadata)==null?void 0:f.creationTimestamp)||"").getTime(),{days:r,hours:d,minutes:c,seconds:o}=n(t),h=a(r,d,c,o);return e.jsx("div",{className:"w-fit",children:h})}},{id:"actions",cell:({row:s})=>e.jsx(ws,{row:s})}];function ea({table:s}){return e.jsxs("div",{className:"flex items-center justify-between overflow-clip px-2",style:{overflowClipMargin:1},children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(Ie,{value:`${s.getState().pagination.pageSize}`,onValueChange:n=>{s.setPageSize(Number(n))},children:[e.jsx(Me,{className:"h-8 w-[70px]",children:e.jsx(Oe,{placeholder:s.getState().pagination.pageSize})}),e.jsx(He,{side:"top",children:[5,10,20,30,40,50].map(n=>e.jsx(W,{value:`${n}`,children:n},n))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(v,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(Ss,{className:"h-4 w-4"})]}),e.jsxs(v,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(Cs,{className:"h-4 w-4"})]}),e.jsxs(v,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(Ds,{className:"h-4 w-4"})]}),e.jsxs(v,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(Ts,{className:"h-4 w-4"})]})]})]})]})}function sa({table:s}){return e.jsxs(ne,{modal:!1,children:[e.jsx(Ue,{asChild:!0,children:e.jsxs(v,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(le,{align:"end",className:"w-[150px]",children:[e.jsx(Ve,{children:"Toggle columns"}),e.jsx(Ne,{}),s.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()).map(n=>e.jsx(ze,{className:"capitalize",checked:n.getIsVisible(),onCheckedChange:a=>n.toggleVisibility(!!a),children:n.id},n.id))]})]})}function aa({column:s,title:n,options:a}){const t=s==null?void 0:s.getFacetedUniqueValues(),r=new Set(s==null?void 0:s.getFilterValue());return e.jsxs(zs,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(v,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(As,{className:"mr-2 h-4 w-4"}),n,(r==null?void 0:r.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(J,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:r.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:r.size>2?e.jsxs(J,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[r.size," selected"]}):a.filter(d=>r.has(d.value)).map(d=>e.jsx(J,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:d.label},d.value))})]})]})}),e.jsx(Gs,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Ge,{children:[e.jsx(Ke,{placeholder:n}),e.jsxs(We,{children:[e.jsx(Ye,{children:"No results found."}),e.jsx(oe,{children:a.map(d=>{const c=r.has(d.value);return e.jsxs(ce,{onSelect:()=>{c?r.delete(d.value):r.add(d.value);const o=Array.from(r);s==null||s.setFilterValue(o.length?o:void 0)},children:[e.jsx("div",{className:ee("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",c?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Ps,{className:ee("h-4 w-4")})}),d.icon&&e.jsx(d.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:d.label}),(t==null?void 0:t.get(d.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:t.get(d.value)})]},d.value)})}),r.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{}),e.jsx(oe,{children:e.jsx(ce,{onSelect:()=>s==null?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}const ta=({fetchData:s})=>{const{setOpen:n}=q();return e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",className:"space-x-1",onClick:()=>n("import"),children:[e.jsx("span",{children:"Import"})," ",e.jsx(Ks,{size:18})]}),e.jsxs(v,{className:"space-x-1",variant:"outline",onClick:()=>n("create"),children:[e.jsx("span",{children:"Create"})," ",e.jsx(Ws,{size:18})]}),e.jsx(v,{onClick:s,variant:"outline",children:"刷新"})]})};function ia({table:s,originalData:n,fetchData:a}){var d;const t=s.getState().columnFilters.length>0,r=[...new Set(n.map(c=>{var o;return(o=c.crd)==null?void 0:o.metadata.namespace}))].map(c=>({value:c,label:c}));return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(Y,{placeholder:"Filter tasks...",value:((d=s.getColumn("name"))==null?void 0:d.getFilterValue())??"",onChange:c=>{var o;return(o=s.getColumn("name"))==null?void 0:o.setFilterValue(c.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsx("div",{className:"flex gap-x-2",children:s.getColumn("namespace")&&e.jsx(aa,{column:s.getColumn("namespace"),title:"命名空间筛选",options:r})}),t&&e.jsxs(v,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(_s,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(sa,{table:s}),e.jsx(ta,{fetchData:a})]})}function na({columns:s,data:n,fetchData:a}){var u;const[t,r]=N.useState({}),[d,c]=N.useState({}),[o,h]=N.useState([]),[f,m]=N.useState([]),j=Os({data:n,columns:s,state:{sorting:f,columnVisibility:d,rowSelection:t,columnFilters:o},enableRowSelection:!0,onRowSelectionChange:r,onSortingChange:m,onColumnFiltersChange:h,onColumnVisibilityChange:c,getCoreRowModel:Hs(),getFilteredRowModel:Fs(),getPaginationRowModel:Js(),getSortedRowModel:$s(),getFacetedRowModel:Ls(),getFacetedUniqueValues:Us()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(ia,{table:j,originalData:n,fetchData:a}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(E,{children:[e.jsx(I,{children:j.getHeaderGroups().map(b=>e.jsx(p,{children:b.headers.map(g=>e.jsx(x,{colSpan:g.colSpan,children:g.isPlaceholder?null:je(g.column.columnDef.header,g.getContext())},g.id))},b.id))}),e.jsx(M,{children:(u=j.getRowModel().rows)!=null&&u.length?j.getRowModel().rows.map(b=>e.jsx(p,{"data-state":b.getIsSelected()&&"selected",children:b.getVisibleCells().map(g=>e.jsx(l,{children:je(g.column.columnDef.cell,g.getContext())},g.id))},b.id)):e.jsx(p,{children:e.jsx(l,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(ea,{table:j})]})}const la=i.object({file:i.instanceof(FileList).refine(s=>s.length>0,{message:"Please upload a file"}).refine(s=>{var n;return["text/csv"].includes((n=s==null?void 0:s[0])==null?void 0:n.type)},"Please upload csv format.")});function ra({open:s,onOpenChange:n}){const a=Ze({resolver:Qe(la),defaultValues:{file:void 0}}),t=a.register("file"),r=()=>{const d=a.getValues("file");if(d&&d[0]){const c={name:d[0].name,size:d[0].size,type:d[0].type};y({title:"You have imported the following file:",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(c,null,2)})})})}n(!1)};return e.jsx(Xe,{open:s,onOpenChange:d=>{n(d),a.reset()},children:e.jsxs(we,{className:"gap-2 sm:max-w-sm",children:[e.jsxs(Re,{className:"text-left",children:[e.jsx(es,{children:"Import Tasks"}),e.jsx(ss,{children:"Import tasks quickly from a CSV file."})]}),e.jsx(as,{...a,children:e.jsx("form",{id:"task-import-form",onSubmit:a.handleSubmit(r),children:e.jsx(ts,{control:a.control,name:"file",render:()=>e.jsxs(is,{className:"mb-2 space-y-1",children:[e.jsx(ns,{children:"File"}),e.jsx(ls,{children:e.jsx(Y,{type:"file",...t,className:"h-8"})}),e.jsx(rs,{})]})})})}),e.jsxs(ds,{className:"gap-2 sm:gap-0",children:[e.jsx(os,{asChild:!0,children:e.jsx(v,{variant:"outline",children:"Close"})}),e.jsx(v,{type:"submit",form:"task-import-form",children:"Import"})]})]})})}const da=[{month:"January",desktop:186,mobile:80},{month:"February",desktop:305,mobile:200},{month:"March",desktop:237,mobile:120},{month:"April",desktop:73,mobile:190},{month:"May",desktop:209,mobile:130},{month:"June",desktop:214,mobile:140}],oa={desktop:{label:"Desktop",color:"#2563eb"},mobile:{label:"Mobile",color:"#60a5fa"}};function ca(){return e.jsxs(e.Fragment,{children:[e.jsx(Ys,{config:oa,className:"min-h-[200px] w-full",children:e.jsxs(cs,{accessibilityLayer:!0,data:da,children:[e.jsx(me,{dataKey:"desktop",fill:"var(--color-desktop)",radius:4}),e.jsx(me,{dataKey:"mobile",fill:"var(--color-mobile)",radius:4})]})}),e.jsxs(C,{className:"h-full border rounded-md",children:[e.jsxs(T,{children:[e.jsx(k,{children:"Create project"}),e.jsx(A,{children:"Deploy your new project in one-click."})]}),e.jsx(_,{children:e.jsx("form",{children:e.jsxs("div",{className:"grid w-full items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx(se,{htmlFor:"name",children:"Name"}),e.jsx(Y,{id:"name",placeholder:"Name of your project"})]}),e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx(se,{htmlFor:"framework",children:"Framework"}),e.jsxs(Ie,{children:[e.jsx(Me,{id:"framework",children:e.jsx(Oe,{placeholder:"Select"})}),e.jsxs(He,{position:"popper",children:[e.jsx(W,{value:"next",children:"Next.js"}),e.jsx(W,{value:"sveltekit",children:"SvelteKit"}),e.jsx(W,{value:"astro",children:"Astro"}),e.jsx(W,{value:"nuxt",children:"Nuxt.js"})]})]})]})]})})}),e.jsxs(K,{className:"flex justify-between",children:[e.jsx(v,{variant:"outline",children:"Cancel"}),e.jsx(v,{children:"Deploy"})]})]})]})}const ma={apiVersion:"apps/v1",kind:"DaemonSet",metadata:{annotations:{"deprecated.daemonset.template.generation":"1","kubectl.kubernetes.io/last-applied-configuration":`{"apiVersion":"apps/v1","kind":"DaemonSet","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"exporter","app.kubernetes.io/name":"node-exporter","app.kubernetes.io/part-of":"kube-prometheus","app.kubernetes.io/version":"1.5.0"},"name":"node-exporter","namespace":"monitoring"},"spec":{"selector":{"matchLabels":{"app.kubernetes.io/component":"exporter","app.kubernetes.io/name":"node-exporter","app.kubernetes.io/part-of":"kube-prometheus"}},"template":{"metadata":{"annotations":{"kubectl.kubernetes.io/default-container":"node-exporter"},"labels":{"app.kubernetes.io/component":"exporter","app.kubernetes.io/name":"node-exporter","app.kubernetes.io/part-of":"kube-prometheus","app.kubernetes.io/version":"1.5.0"}},"spec":{"automountServiceAccountToken":true,"containers":[{"args":["--web.listen-address=127.0.0.1:9100","--path.sysfs=/host/sys","--path.rootfs=/host/root","--path.udev.data=/host/root/run/udev/data","--no-collector.wifi","--no-collector.hwmon","--collector.filesystem.mount-points-exclude=^/(dev|proc|sys|run/k3s/containerd/.+|var/lib/docker/.+|var/lib/kubelet/pods/.+)($|/)","--collector.netclass.ignored-devices=^(veth.*|[a-f0-9]{15})$","--collector.netdev.device-exclude=^(veth.*|[a-f0-9]{15})$"],"image":"quay.io/prometheus/node-exporter:v1.5.0","name":"node-exporter","resources":{"limits":{"cpu":"250m","memory":"180Mi"},"requests":{"cpu":"102m","memory":"180Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"add":["SYS_TIME"],"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/host/sys","mountPropagation":"HostToContainer","name":"sys","readOnly":true},{"mountPath":"/host/root","mountPropagation":"HostToContainer","name":"root","readOnly":true}]},{"args":["--logtostderr","--secure-listen-address=[$(IP)]:9100","--tls-cipher-suites=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305","--upstream=http://127.0.0.1:9100/"],"env":[{"name":"IP","valueFrom":{"fieldRef":{"fieldPath":"status.podIP"}}}],"image":"quay.io/brancz/kube-rbac-proxy:v0.14.0","name":"kube-rbac-proxy","ports":[{"containerPort":9100,"hostPort":9100,"name":"https"}],"resources":{"limits":{"cpu":"20m","memory":"40Mi"},"requests":{"cpu":"10m","memory":"20Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true,"runAsGroup":65532,"runAsNonRoot":true,"runAsUser":65532}}],"hostNetwork":true,"hostPID":true,"nodeSelector":{"kubernetes.io/os":"linux"},"priorityClassName":"system-cluster-critical","securityContext":{"runAsNonRoot":true,"runAsUser":65534},"serviceAccountName":"node-exporter","tolerations":[{"operator":"Exists"}],"volumes":[{"hostPath":{"path":"/sys"},"name":"sys"},{"hostPath":{"path":"/"},"name":"root"}]}},"updateStrategy":{"rollingUpdate":{"maxUnavailable":"10%"},"type":"RollingUpdate"}}}
`},creationTimestamp:"2025-02-17T10:01:28Z",generation:1,labels:{"app.kubernetes.io/component":"exporter","app.kubernetes.io/name":"node-exporter","app.kubernetes.io/part-of":"kube-prometheus","app.kubernetes.io/version":"1.5.0"},name:"demo-exporter",namespace:"default"},spec:{revisionHistoryLimit:10,selector:{matchLabels:{"app.kubernetes.io/component":"exporter","app.kubernetes.io/name":"node-exporter","app.kubernetes.io/part-of":"kube-prometheus"}},template:{metadata:{annotations:{"kubectl.kubernetes.io/default-container":"node-exporter"},creationTimestamp:null,labels:{"app.kubernetes.io/component":"exporter","app.kubernetes.io/name":"node-exporter","app.kubernetes.io/part-of":"kube-prometheus","app.kubernetes.io/version":"1.5.0"}},spec:{automountServiceAccountToken:!0,containers:[{args:["--web.listen-address=127.0.0.1:9100","--path.sysfs=/host/sys","--path.rootfs=/host/root","--path.udev.data=/host/root/run/udev/data","--no-collector.wifi","--no-collector.hwmon","--collector.filesystem.mount-points-exclude=^/(dev|proc|sys|run/k3s/containerd/.+|var/lib/docker/.+|var/lib/kubelet/pods/.+)($|/)","--collector.netclass.ignored-devices=^(veth.*|[a-f0-9]{15})$","--collector.netdev.device-exclude=^(veth.*|[a-f0-9]{15})$"],image:"quay.io/prometheus/node-exporter:v1.5.0",imagePullPolicy:"IfNotPresent",name:"node-exporter",resources:{limits:{cpu:"250m",memory:"180Mi"},requests:{cpu:"102m",memory:"180Mi"}},securityContext:{allowPrivilegeEscalation:!1,capabilities:{add:["SYS_TIME"],drop:["ALL"]},readOnlyRootFilesystem:!0},terminationMessagePath:"/dev/termination-log",terminationMessagePolicy:"File",volumeMounts:[{mountPath:"/host/sys",mountPropagation:"HostToContainer",name:"sys",readOnly:!0},{mountPath:"/host/root",mountPropagation:"HostToContainer",name:"root",readOnly:!0}]},{args:["--logtostderr","--secure-listen-address=[$(IP)]:9100","--tls-cipher-suites=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305","--upstream=http://127.0.0.1:9100/"],env:[{name:"IP",valueFrom:{fieldRef:{apiVersion:"v1",fieldPath:"status.podIP"}}}],image:"quay.io/brancz/kube-rbac-proxy:v0.14.0",imagePullPolicy:"IfNotPresent",name:"kube-rbac-proxy",ports:[{containerPort:9100,hostPort:9100,name:"https",protocol:"TCP"}],resources:{limits:{cpu:"20m",memory:"40Mi"},requests:{cpu:"10m",memory:"20Mi"}},securityContext:{allowPrivilegeEscalation:!1,capabilities:{drop:["ALL"]},readOnlyRootFilesystem:!0,runAsGroup:65532,runAsNonRoot:!0,runAsUser:65532},terminationMessagePath:"/dev/termination-log",terminationMessagePolicy:"File"}],dnsPolicy:"ClusterFirst",hostNetwork:!0,hostPID:!0,nodeSelector:{"kubernetes.io/os":"linux"},priorityClassName:"system-cluster-critical",restartPolicy:"Always",schedulerName:"default-scheduler",securityContext:{runAsNonRoot:!0,runAsUser:65534},serviceAccount:"node-exporter",serviceAccountName:"node-exporter",terminationGracePeriodSeconds:30,tolerations:[{operator:"Exists"}],volumes:[{hostPath:{path:"/sys",type:""},name:"sys"},{hostPath:{path:"/",type:""},name:"root"}]}},updateStrategy:{rollingUpdate:{maxSurge:0,maxUnavailable:"10%"},type:"RollingUpdate"}},status:{currentNumberScheduled:5,desiredNumberScheduled:5,numberAvailable:5,numberMisscheduled:0,numberReady:5,observedGeneration:1,updatedNumberScheduled:5}};function fe({open:s,onOpenChange:n,currentRow:a}){const t=!!a,[r,d]=N.useState(""),[c,o]=N.useState(""),[h,f]=N.useState(!1);N.useEffect(()=>{a!=null&&a.raw&&d(JSON.stringify(a.raw,null,2)),o(JSON.stringify(ma,null,2))},[a]);const m=()=>{try{if(!(a!=null&&a.namespace)||!(a!=null&&a.name)){y({title:"更新失败",description:"缺少必要的Pod信息",variant:"destructive"});return}const u={group:"apps",version:"v1",resource:"daemonsets",namespace:a.namespace,name:a.name,data:JSON.parse(r)};fetch("/api/gvr",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).then(b=>{if(!b.ok)throw new Error("更新失败");return b.json()}).then(b=>{y({title:"更新成功",description:`Daemonset ${a.name} 配置已更新`}),n(!1)}).catch(b=>{y({title:"更新失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}},j=()=>{try{const u=JSON.parse(c);u.metadata.name===""&&y({title:"缺少必要条件",description:"metdata.name 不能为空"});const b={group:"apps",version:"v1",resource:"daemonsets",namespace:u.metadata.namespace===""?"default":u.metadata.namespace,name:u.metadata.name,data:u};fetch("/api/gvr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}).then(g=>{if(!g.ok)throw new Error("新增失败");return g.json()}).then(g=>{y({title:"新增成功",description:`Daemonset ${u.metadata.name} 配置已新增`}),n(!1)}).catch(g=>{y({title:"新增失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsx(De,{open:s,onOpenChange:u=>{n(u)},children:e.jsxs(Te,{side:"right",className:"w-[50%] sm:max-w-[90%] flex flex-col overflow-y-auto",children:[e.jsxs(ke,{className:"text-left",children:[e.jsxs(Ae,{children:[t?"更新":"创建"," DaemonSet"]}),e.jsx(Pe,{children:t?"更新DaemonSet配置信息":"创建新的DaemonSet配置"})]}),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(v,{variant:"outline",onClick:()=>f(!h),children:h?"切换到视图模式":"切换到编辑模式"})}),h?e.jsx(te,{value:r,onChange:u=>d(u.target.value),className:"flex-1 font-mono resize-none",placeholder:"请输入JSON数据..."}):e.jsx(Fe,{src:(a==null?void 0:a.raw)||{},enableClipboard:!0,displayDataTypes:!1,name:!1})]}):e.jsx(te,{value:c,onChange:u=>{o(u.target.value)},className:"flex-1 font-mono resize-none",placeholder:"请输入Pod配置..."}),e.jsxs(_e,{className:"gap-2 mt-4",children:[e.jsx(Ee,{asChild:!0,children:e.jsx(v,{variant:"outline",children:"关闭"})}),t?h&&e.jsx(v,{form:"tasks-form",onClick:m,children:"更新配置"}):e.jsx(v,{form:"tasks-form",onClick:j,children:"新建"})]})]})})}function ha({open:s,onOpenChange:n,podName:a,namespace:t,containerName:r}){const d=`/ws/logs/html/${t}/${a}/${r}`;return e.jsx(re,{open:s,onOpenChange:n,children:e.jsx(de,{className:"h-[80vh] mt-0",children:e.jsx("div",{className:"w-full h-full",children:e.jsx("iframe",{src:d,className:"w-full h-full rounded-md border",style:{minHeight:"500px"}})})})})}function xa({open:s,onOpenChange:n,podName:a,namespace:t,containerName:r}){const d=`/ws/ssh/html/${t}/${a}/${r}`;return e.jsx(re,{open:s,onOpenChange:n,children:e.jsx(de,{className:"h-[80vh] mt-0",children:e.jsx("div",{className:"w-full h-full",children:e.jsx("iframe",{src:d,className:"w-full h-full rounded-md",style:{minHeight:"500px"}})})})})}function pa(){return e.jsxs("div",{className:"*:data-[slot=card]:from-primary/5 *:data-[slot=card]:to-card dark:*:data-[slot=card]:bg-card grid grid-cols-1 gap-4 px-4 *:data-[slot=card]:bg-gradient-to-t *:data-[slot=card]:shadow-xs lg:px-6 @xl/main:grid-cols-2 @5xl/main:grid-cols-4",children:[e.jsxs(C,{className:"@container/card",children:[e.jsxs(T,{children:[e.jsx(A,{children:"Total Revenue"}),e.jsx(k,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"$1,250.00"}),e.jsx(Q,{children:e.jsxs(J,{variant:"outline",children:[e.jsx(U,{}),"+12.5%"]})})]}),e.jsxs(K,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Trending up this month ",e.jsx(U,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Visitors for the last 6 months"})]})]}),e.jsxs(C,{className:"@container/card",children:[e.jsxs(T,{children:[e.jsx(A,{children:"New Customers"}),e.jsx(k,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"1,234"}),e.jsx(Q,{children:e.jsxs(J,{variant:"outline",children:[e.jsx(ue,{}),"-20%"]})})]}),e.jsxs(K,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Down 20% this period ",e.jsx(ue,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Acquisition needs attention"})]})]}),e.jsxs(C,{className:"@container/card",children:[e.jsxs(T,{children:[e.jsx(A,{children:"Active Accounts"}),e.jsx(k,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"45,678"}),e.jsx(Q,{children:e.jsxs(J,{variant:"outline",children:[e.jsx(U,{}),"+12.5%"]})})]}),e.jsxs(K,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Strong user retention ",e.jsx(U,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Engagement exceed targets"})]})]}),e.jsxs(C,{className:"@container/card",children:[e.jsxs(T,{children:[e.jsx(A,{children:"Growth Rate"}),e.jsx(k,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"4.5%"}),e.jsx(Q,{children:e.jsxs(J,{variant:"outline",children:[e.jsx(U,{}),"+4.5%"]})})]}),e.jsxs(K,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Steady performance increase ",e.jsx(U,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Meets growth projections"})]})]})]})}function ja({currentRow:s}){const n=N.useMemo(()=>!s||!s.crd||!s.crd.spec?[]:s.crd.spec.template.spec.containers.map((t,r)=>{var d;return e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:t.name}),e.jsx(l,{className:"font-medium",children:t.imagePullPolicy}),e.jsx(l,{className:"font-medium",children:e.jsx("div",{className:"w-48 truncate hover:whitespace-normal",children:t.image})}),e.jsx(l,{children:e.jsx("div",{className:"w-48 truncate hover:whitespace-normal",children:t.command?t.command.join(", "):"-"})}),e.jsx(l,{children:e.jsx("div",{className:"w-48 truncate hover:whitespace-normal",children:t.args?t.args.join(", "):"-"})}),e.jsx(l,{className:"font-medium",children:s.crd.spec.revisionHistoryLimit}),e.jsx(l,{className:"font-medium",children:e.jsx("div",{className:"w-48",children:Object.entries((d=s==null?void 0:s.crd)==null?void 0:d.spec.selector.matchLabels).map(([c,o])=>`${c}=${o}`).reduce((c,o)=>`${c}, ${o}`)})}),e.jsx(l,{className:"font-medium",children:e.jsx("div",{className:"w-48 truncate hover:whitespace-normal",children:s.crd.spec.template.spec.serviceAccount})}),e.jsx(l,{className:"font-medium",children:s.crd.spec.template.spec.schedulerName})]},`${t.name}-${r}`)}),[s]);return e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(k,{children:s==null?void 0:s.crd.metadata.name}),e.jsxs(A,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsx(_,{className:"space-y-2",children:e.jsxs(E,{children:[e.jsx(Vs,{children:"容器详情"}),e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"ImagePullPolicy"}),e.jsx(x,{children:"Image"}),e.jsx(x,{children:"Command"}),e.jsx(x,{children:"Args"}),e.jsx(x,{children:"HistoryLimit"}),e.jsx(x,{children:"Selector"}),e.jsx(x,{children:"ServiceAccount"}),e.jsx(x,{children:"SchedulerName"})]})}),e.jsx(M,{children:n})]})})]})}function z({types:s,kind:n,name:a,namespace:t,keys:r,values:d}){const{currentRow:c,setCurrentRow:o}=q(),[h,f]=N.useState(""),[m,j]=N.useState(""),u=async()=>{if(!m||!h){y({title:"键或值不能为空",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:m,value:h},null,2)})})});return}try{if(n==="label"){const S=await V.patch("/api/gvr/patchstrate",{group:"apps",version:"v1",resource:"daemonsets",name:a,namespace:t,patchdatastrate:{metadata:{labels:{[m]:h}}}}),P={...c,crd:S.data};o(P)}else if(n==="annotation"){const S=await V.patch("/api/gvr/patchstrate",{group:"apps",version:"v1",resource:"daemonsets",name:a,namespace:t,patchdatastrate:{metadata:{annotations:{[m]:h}}}}),P={...c,crd:S.data};o(P)}y({title:"请求成功",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:m,value:h},null,2)})})})}catch(S){y({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(S,null,2)})})})}},b=async()=>{var S,P;if(!m){y({title:"键不能为空",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:m},null,2)})})});return}if(window.confirm(`确定要删除键 ${m} 吗？`))try{if(n==="label"){const D={...c};(S=D.metadata)!=null&&S.labels&&delete D.metadata.labels[m];const F=await V.patch("/api/gvr/patchstrate",{group:"apps",version:"v1",resource:"daemonsets",name:a,namespace:t,patchdatastrate:{metadata:{labels:{[m]:null}}}}),O={...c,crd:F.data};o(O)}else if(n==="annotation"){const D={...c};(P=D.metadata)!=null&&P.annotations&&delete D.metadata.annotations[m];const F=await V.patch("/api/gvr/patchstrate",{group:"apps",version:"v1",resource:"daemonsets",name:a,namespace:t,patchdatastrate:{metadata:{annotations:{[m]:null}}}}),O={...c,crd:F.data};o(O)}y({title:"删除成功",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:m,value:h},null,2)})})})}catch(D){y({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(D,null,2)})})})}};N.useEffect(()=>{f(d),j(r)},[d,r]);const g=()=>{s==="add"||s==="edit"?u():s==="delete"&&b()};return e.jsxs(De,{children:[e.jsx(ms,{asChild:!0,children:s==="edit"?e.jsx(v,{size:"sm",variant:"link",className:"w-20 text-blue-300 hover:text-blue-500",onClick:u,children:"编辑"}):s==="delete"?e.jsx(v,{size:"sm",variant:"link",className:"w-20 text-red-300 hover:text-red-500",onClick:b,children:"删除"}):s==="add"?e.jsx(v,{size:"sm",variant:"link",className:"w-20 text-green-300 hover:text-green-500",onClick:u,children:"添加"}):null}),e.jsxs(Te,{side:"top",children:[e.jsxs(ke,{children:[e.jsxs(Ae,{children:[s==="edit"?"编辑":s==="add"?"添加":s==="delete"?"删除":null," 节点 ",a," ",n==="label"?"标签":n==="annotation"?"注释":""]}),e.jsxs(Pe,{children:["新增节点 ",a," ",n==="label"?"标签":n==="annotation"?"注释":"","，请填写相关信息。",s==="edit"?"编辑节点":s==="add"?"添加节点":s==="delete"?"删除节点":null," ",a," ",n==="label"?"标签":n==="annotation"?"注释":"","，请填写相关信息。"]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(se,{htmlFor:"name",className:"text-right",children:"键"}),e.jsx(Y,{id:"name",value:m,disabled:s!=="add",onChange:S=>j(S.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(se,{htmlFor:"username",className:"text-right",children:"值"}),e.jsx(Y,{id:"username",value:h,onChange:S=>f(S.target.value),className:"col-span-3"})]})]}),e.jsx(_e,{children:e.jsx(Ee,{asChild:!0,children:e.jsx(v,{type:"submit",onClick:g,children:"提交"})})})]})]})}function ua({currentRow:s}){const n=N.useMemo(()=>!s||!s.crd||!s.crd.metadata.labels?[]:Object.entries(s.crd.metadata.labels).map(([a,t])=>{var r,d,c,o,h,f,m,j;return e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:a}),e.jsx(l,{children:t}),e.jsx(l,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(z,{types:"edit",kind:"label",name:((d=(r=s==null?void 0:s.crd)==null?void 0:r.metadata)==null?void 0:d.name)||"",namespace:((o=(c=s==null?void 0:s.crd)==null?void 0:c.metadata)==null?void 0:o.namespace)||"",keys:a,values:typeof t=="string"?t:""}),e.jsx(z,{types:"delete",kind:"label",name:((f=(h=s==null?void 0:s.crd)==null?void 0:h.metadata)==null?void 0:f.name)||"",namespace:((j=(m=s==null?void 0:s.crd)==null?void 0:m.metadata)==null?void 0:j.namespace)||"",keys:a,values:typeof t=="string"?t:""})]})})]},a)}),[s]);return e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsxs(k,{children:[s==null?void 0:s.crd.metadata.name,e.jsx(z,{types:"add",kind:"label",name:s?s.crd.metadata.name:"",namespace:s?s.crd.metadata.namespace:"",keys:"",values:""})]}),e.jsxs(A,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsx(_,{className:"space-y-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{className:"w-[50%]",children:"键"}),e.jsx(x,{className:"w-[50%]",children:"值"})]})}),e.jsx(M,{children:n})]})})]})}function fa({currentRow:s}){const n=N.useMemo(()=>!s||!s.crd||!s.crd.metadata.annotations?[]:Object.entries(s.crd.metadata.annotations).map(([a,t])=>{var r,d,c,o,h,f,m,j;return e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:a}),e.jsx(l,{children:t}),e.jsx(l,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(z,{types:"edit",kind:"annotation",name:((d=(r=s==null?void 0:s.crd)==null?void 0:r.metadata)==null?void 0:d.name)||"",namespace:((o=(c=s==null?void 0:s.crd)==null?void 0:c.metadata)==null?void 0:o.namespace)||"",keys:a,values:typeof t=="string"?t:""}),e.jsx(z,{types:"delete",kind:"annotation",name:((f=(h=s==null?void 0:s.crd)==null?void 0:h.metadata)==null?void 0:f.name)||"",namespace:((j=(m=s==null?void 0:s.crd)==null?void 0:m.metadata)==null?void 0:j.namespace)||"",keys:a,values:typeof t=="string"?t:""})]})})]},a)}),[s]);return e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsxs(k,{children:[s==null?void 0:s.crd.metadata.name,e.jsx(z,{types:"add",kind:"annotation",name:s?s.crd.metadata.name:"",namespace:s?s.crd.metadata.namespace:"",keys:"",values:""})]}),e.jsxs(A,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsx(_,{className:"space-y-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{className:"w-[50%]",children:"键"}),e.jsx(x,{className:"w-[50%]",children:"值"})]})}),e.jsx(M,{children:n})]})})]})}function ga({currentRow:s}){const n=N.useMemo(()=>!s||!s.crd||!s.crd.status||!s.crd.status.conditions?[]:Object.entries(s.crd.status.conditions).map((t,r)=>e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:t[1].type}),e.jsx(l,{children:t[1].status==="True"?e.jsx(ae,{className:"h-4 w-4 text-green-500"}):e.jsx(ie,{className:"h-4 w-4 text-gray-400"})}),e.jsx(l,{children:t[1].lastTransitionTime})]},r)),[s]),a=N.useMemo(()=>{if(!s||!s.crd||!s.crd.status)return[];const t=[];return s.crd.status.availableReplicas&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"currentNumberScheduled"}),e.jsx(l,{children:s.crd.status.currentNumberScheduled}),e.jsx(l,{children:"-"})]},"currentNumberScheduled")),s.crd.status.numberMisscheduled&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"numberMisscheduled"}),e.jsx(l,{children:s.crd.status.numberMisscheduled}),e.jsx(l,{children:"-"})]},"numberMisscheduled")),s.crd.status.desiredNumberScheduled&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"desiredNumberScheduled"}),e.jsx(l,{children:s.crd.status.desiredNumberScheduled}),e.jsx(l,{children:"-"})]},"desiredNumberScheduled")),s.crd.status.numberReady&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"numberReady"}),e.jsx(l,{children:s.crd.status.numberReady}),e.jsx(l,{children:"-"})]},"numberReady")),s.crd.status.numberUnavailable&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"numberUnavailable"}),e.jsx(l,{children:s.crd.status.numberUnavailable}),e.jsx(l,{children:"-"})]},"numberUnavailable")),s.crd.status.numberAvailable&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"numberAvailable"}),e.jsx(l,{children:s.crd.status.numberAvailable}),e.jsx(l,{children:"-"})]},"numberAvailable")),s.crd.status.collisionCount&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"collisionCount"}),e.jsx(l,{children:s.crd.status.collisionCount}),e.jsx(l,{children:"-"})]},"collisionCount")),s.crd.status.observedGeneration&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"observedGeneration"}),e.jsx(l,{children:s.crd.status.observedGeneration}),e.jsx(l,{children:"-"})]},"observedGeneration")),s.crd.status.updatedNumberScheduled&&t.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"updatedNumberScheduled"}),e.jsx(l,{children:s.crd.status.updatedNumberScheduled}),e.jsx(l,{children:"-"})]},"updatedNumberScheduled")),t},[s]);return e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(k,{children:s==null?void 0:s.crd.metadata.name}),e.jsxs(A,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsx(_,{className:"space-y-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{className:"w-[30%]",children:"Condition"}),e.jsx(x,{className:"w-[30%]",children:"Status"}),e.jsx(x,{className:"w-[40%]",children:"Timestamp"})]})}),e.jsxs(M,{children:[n,a]})]})})]})}function Na({currentRow:s}){const n=N.useMemo(()=>!s||!s.raw||!s.raw.status?[]:Object.entries(s.raw.status).map(([a,t])=>e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:a}),e.jsx(l,{children:JSON.stringify(t)})]},a)),[s]);return e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(k,{children:s==null?void 0:s.raw.metadata.name}),e.jsxs(A,{children:["命名空间：",s==null?void 0:s.raw.metadata.namespace]})]}),e.jsx(_,{className:"space-y-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{className:"w-[100px]",children:"属性"}),e.jsx(x,{children:"值"})]})}),e.jsxs(M,{children:[s&&Object.entries(s.raw.metadata).map(([a,t])=>e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:a}),e.jsx(l,{children:JSON.stringify(t)})]},a)),n,s&&Object.entries(s.raw.spec).map(([a,t])=>a!=="containers"&&e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:a}),e.jsx(l,{children:JSON.stringify(t)})]},a))]})]})})]}),e.jsxs(C,{className:"mt-4",children:[e.jsxs(T,{children:[e.jsx(k,{children:"Container信息"}),e.jsx(A,{children:"Container原始信息展示"})]}),e.jsx(_,{className:"space-y-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{className:"w-[100px]",children:"属性"}),e.jsx(x,{className:"w-[auto]",children:"值"})]})}),e.jsx(M,{children:s&&s.raw.spec.containers.map((a,t)=>Object.entries(a).map(([r,d])=>e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:r}),e.jsx(l,{children:e.jsx(ve,{children:e.jsxs(ye,{children:[e.jsx(Se,{children:e.jsx("div",{className:"whitespace-pre-wrap break-all",children:JSON.stringify(d)})}),e.jsx(Ce,{className:"whitespace-pre-wrap break-all",children:JSON.stringify(d)})]})})})]},`${t}-${r}`)))})]})})]})]})}const ba=s=>s.emptyDir?"emptyDir":s.persistentVolumeClaim?"persistenVolumeClaim":s.configMap?"configMap":s.secret?"secret":s.projected?"projected":"Unknown";function va({currentRow:s}){var t;const n=N.useMemo(()=>!s||!s.raw||!s.raw.metadata.ownerReferences?[]:Object.entries(s.raw.metadata.ownerReferences).map((r,d)=>e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:r[1].name}),e.jsx(l,{className:"font-medium",children:r[1].kind}),e.jsx(l,{children:r[1].controller?e.jsx(ae,{className:"h-4 w-4 text-green-500"}):e.jsx(ie,{className:"h-4 w-4 text-gray-400"})}),e.jsx(l,{children:r[1].blockOwnerDeletion?e.jsx(ae,{className:"h-4 w-4 text-green-500"}):e.jsx(ie,{className:"h-4 w-4 text-gray-400"})})]},d)),[s]),a=N.useMemo(()=>!s||!s.raw||!s.raw.spec.volumes?[]:Object.entries(s.raw.spec.volumes).map((r,d)=>e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:r[1].name}),e.jsx(l,{className:"font-medium",children:ba(r[1])}),e.jsx(l,{className:"font-medium",children:JSON.stringify(r[1],null,2)})]},d)),[s]);return e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsxs(k,{children:["关联References ",(t=s==null?void 0:s.raw.metadata.ownerReferences)==null?void 0:t.length]}),e.jsx(A,{children:"OwnerReferences"})]}),e.jsx(_,{className:"space-y-2",children:(s==null?void 0:s.raw.metadata.ownerReferences)&&e.jsx("div",{className:"mb-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Kind"}),e.jsx(x,{children:"Controller"}),e.jsx(x,{children:"是否集联删除"})]})}),e.jsx(M,{children:n})]})})})]}),e.jsxs(C,{className:"mt-4",children:[e.jsxs(T,{children:[e.jsxs(k,{children:["引用资源 ",s==null?void 0:s.raw.spec.volumes.length]}),e.jsx(A,{children:"磁盘卷配置"})]}),e.jsx(_,{className:"space-y-2",children:(s==null?void 0:s.raw.spec.volumes)&&e.jsx("div",{className:"mb-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Kind"}),e.jsx(x,{children:"Detail"})]})}),e.jsx(M,{children:a})]})})})]}),e.jsx(Na,{currentRow:s})]})}function ya({currentRow:s}){const n=N.useMemo(()=>{if(!s||!s.raw||!s.raw.spec.affinity)return[];const t=s.raw.spec.affinity,r=[];return t.nodeAffinity&&(t.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution&&r.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"节点亲和性"}),e.jsx(l,{className:"font-medium",children:"硬亲和性"}),e.jsx(l,{children:JSON.stringify(t.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution,null,2)})]},"node-affinity-required")),t.nodeAffinity.preferredDuringSchedulingIgnoredDuringExecution&&r.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"节点亲和性"}),e.jsx(l,{className:"font-medium",children:"软亲和性"}),e.jsx(l,{children:JSON.stringify(t.nodeAffinity.preferredDuringSchedulingIgnoredDuringExecution,null,2)})]},"node-affinity-preferred"))),t.podAffinity&&(t.podAffinity.requiredDuringSchedulingIgnoredDuringExecution&&r.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"Pod亲和性"}),e.jsx(l,{className:"font-medium",children:"硬亲和性"}),e.jsx(l,{children:JSON.stringify(t.podAffinity.requiredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-affinity-required")),t.podAffinity.preferredDuringSchedulingIgnoredDuringExecution&&r.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"Pod亲和性"}),e.jsx(l,{className:"font-medium",children:"软亲和性"}),e.jsx(l,{children:JSON.stringify(t.podAffinity.preferredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-affinity-preferred"))),t.podAntiAffinity&&(t.podAntiAffinity.requiredDuringSchedulingIgnoredDuringExecution&&r.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"Pod反亲和性"}),e.jsx(l,{className:"font-medium",children:"硬反亲和性"}),e.jsx(l,{children:JSON.stringify(t.podAntiAffinity.requiredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-anti-affinity-required")),t.podAntiAffinity.preferredDuringSchedulingIgnoredDuringExecution&&r.push(e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:"Pod反亲和性"}),e.jsx(l,{className:"font-medium",children:"软反亲和性"}),e.jsx(l,{children:JSON.stringify(t.podAntiAffinity.preferredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-anti-affinity-preferred"))),r},[s]),a=N.useMemo(()=>!s||!s.raw||!s.raw.spec.tolerations?[]:s.raw.spec.tolerations.map((t,r)=>e.jsxs(p,{children:[e.jsx(l,{className:"font-medium",children:t.key||"-"}),e.jsx(l,{className:"font-medium",children:t.operator||"-"}),e.jsx(l,{className:"font-medium",children:t.value||"-"}),e.jsx(l,{className:"font-medium",children:t.effect||"-"}),e.jsx(l,{className:"font-medium",children:t.tolerationSeconds?t.tolerationSeconds:"无限期"})]},r)),[s]);return e.jsxs(e.Fragment,{children:[(s==null?void 0:s.raw.spec.affinity)&&e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(k,{children:s==null?void 0:s.raw.metadata.name}),e.jsxs(A,{children:["命名空间：",s==null?void 0:s.raw.metadata.namespace]})]}),e.jsx(_,{className:"space-y-2",children:e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-lg text-left font-semibold",children:"亲和性配置"}),e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{children:"类型"}),e.jsx(x,{children:"亲和性类型"}),e.jsx(x,{children:"配置详情"})]})}),e.jsx(M,{children:n})]})]})})]}),e.jsxs(C,{className:"mt-4",children:[e.jsxs(T,{children:[e.jsx(k,{children:s==null?void 0:s.raw.metadata.name}),e.jsxs(A,{children:["命名空间：",s==null?void 0:s.raw.metadata.namespace]})]}),e.jsx(_,{className:"space-y-2",children:(s==null?void 0:s.raw.spec.tolerations)&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("h3",{className:"text-lg text-left font-semibold",children:["容忍度配置 ",s==null?void 0:s.raw.spec.tolerations.length]}),e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Key"}),e.jsx(x,{children:"Operator"}),e.jsx(x,{children:"Value"}),e.jsx(x,{children:"Effect"}),e.jsx(x,{children:"容忍时间(秒)"})]})}),e.jsx(M,{children:a})]})]})})]})]})}function Sa({currentRow:s}){const[n,a]=N.useState([]),t=async()=>{var o,h,f,m;try{const j=await V.post("/api/gvr/list",{group:"",version:"v1",resource:"events",listoptions:{fieldSelector:`involvedObject.name=${(h=(o=s==null?void 0:s.raw)==null?void 0:o.metadata)==null?void 0:h.name},involvedObject.namespace=${(m=(f=s==null?void 0:s.raw)==null?void 0:f.metadata)==null?void 0:m.namespace}`,limit:1e3,sortBy:"lastTimestamp",sortOrder:"desc"}});a(j.data.items)}catch(j){y({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(j,null,2)})})})}},r=o=>{const f=Date.now()-o,m=24*3600*1e3,j=3600*1e3,u=60*1e3,b=Math.floor(f/m),g=f%m,S=Math.floor(g/j),P=g%j,D=Math.floor(P/u),F=P%u,O=Math.round(F/1e3);return{days:b,hours:S,minutes:D,seconds:O}},d=(o,h,f,m)=>{let j="";return o>0&&(j+=`${o}d `),h>0&&(j+=`${h}h `),f>0&&(j+=`${f}m `),m>0&&(j+=`${m}s`),j},c=o=>{const h=new Date(o).getTime(),{days:f,hours:m,minutes:j,seconds:u}=r(h);return d(f,m,j,u)};return N.useEffect(()=>{t()},[]),e.jsxs(C,{children:[n.length>0&&e.jsx(T,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(k,{children:n[0].involvedObject.name}),e.jsxs(A,{children:["命名空间：",n[0].involvedObject.namespace]})]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:t,children:[e.jsx(Bs,{className:"h-4 w-4 mr-2"}),"刷新"]})]})}),e.jsx(_,{className:"space-y-2",children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(x,{className:"w-[40px]",children:"Kind"}),e.jsx(x,{className:"w-[100px]",children:"Reason"}),e.jsx(x,{className:"w-[500px]",children:"Message"}),e.jsx(x,{className:"w-[80px]",children:"Source"}),e.jsx(x,{className:"w-[80px]",children:"Type"}),e.jsx(x,{className:"w-[80px]",children:"Age"})]})}),e.jsx(M,{children:n.length>0&&n.map((o,h)=>e.jsxs(p,{children:[e.jsx(l,{children:o.involvedObject.kind}),e.jsx(l,{children:o.reason}),e.jsx(l,{className:"whitespace-pre-wrap break-all max-w-[300px]",children:o.message}),e.jsx(l,{children:o.source.component}),e.jsx(l,{children:o.type}),e.jsx(l,{children:e.jsx("div",{className:"w-fit",children:c(o.lastTimestamp)})})]},h))})]})})]})}function Ca({open:s,onOpenChange:n,currentRow:a}){var f,m,j,u,b,g,S,P;const[t,r]=N.useState(!1),[d,c]=N.useState(""),{setCurrentRow:o}=q();N.useEffect(()=>{a!=null&&a.crd&&c(JSON.stringify(a.crd,null,2))},[a]);const h=()=>{var D,F,O,B;try{const Z={group:"apps",version:"v1",resource:"daemonsets",namespace:(F=(D=a==null?void 0:a.crd)==null?void 0:D.metadata)==null?void 0:F.namespace,name:(B=(O=a==null?void 0:a.crd)==null?void 0:O.metadata)==null?void 0:B.name,data:t?JSON.parse(d):a==null?void 0:a.crd};fetch("/api/gvr",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z)}).then(L=>L.json()).then(L=>{const $e={...a,crd:L.data};o($e),y({title:"更新成功",description:"Deployments配置已更新"})}).catch(L=>{y({title:"更新失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsx(re,{open:s,onOpenChange:n,children:e.jsx(de,{children:e.jsxs(hs,{defaultValue:"container",className:"w-full",children:[e.jsxs(xs,{className:"grid w-full grid-cols-5 gap-2",children:[e.jsxs(G,{value:"container",children:["容器",e.jsx(X,{className:"h-5 w-5 ml-1",children:e.jsx(w,{className:"text-xs",children:((f=a.crd.spec.template.spec.containers)==null?void 0:f.length)||0})})]}),e.jsxs(G,{value:"label",children:["标签",e.jsx(X,{className:"h-5 w-5 ml-1",children:e.jsx(w,{className:"text-xs",children:(j=(m=a==null?void 0:a.crd)==null?void 0:m.metadata)!=null&&j.labels?Object.keys(a.crd.metadata.labels).length:0})})]}),e.jsxs(G,{value:"annotation",children:["注释",e.jsx(X,{className:"h-5 w-5 ml-1",children:e.jsx(w,{className:"text-xs",children:(b=(u=a==null?void 0:a.crd)==null?void 0:u.metadata)!=null&&b.annotations?Object.keys(a.crd.metadata.annotations).length:0})})]}),e.jsxs(G,{value:"status",children:["状态",e.jsx(X,{className:"h-5 w-5 ml-1",children:e.jsx(w,{className:"text-xs",children:(S=(g=a==null?void 0:a.crd)==null?void 0:g.status)!=null&&S.conditions?Object.keys((P=a==null?void 0:a.crd.status)==null?void 0:P.conditions).length:0})})]}),e.jsx(G,{value:"jsondata",children:"查看或编辑"})]}),e.jsx($,{value:"container",className:"h-[80vh] overflow-y-auto",children:e.jsx(ja,{currentRow:a})}),e.jsx($,{value:"label",className:"h-[80vh] overflow-y-auto",children:e.jsx(ua,{currentRow:a})}),e.jsx($,{value:"annotation",className:"h-[80vh] overflow-y-auto",children:e.jsx(fa,{currentRow:a})}),e.jsx($,{value:"status",className:"h-[80vh] overflow-y-auto",children:e.jsx(ga,{currentRow:a})}),e.jsx($,{value:"relative",className:"h-[80vh] overflow-y-auto",children:e.jsx(va,{currentRow:a})}),e.jsx($,{value:"diaodu",className:"h-[80vh] overflow-y-auto",children:e.jsx(ya,{currentRow:a})}),e.jsx($,{value:"event",className:"h-[80vh] overflow-y-auto",children:e.jsx(Sa,{currentRow:a})}),e.jsx($,{value:"monitor",className:"h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"h-[80vh] grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"rounded-md",children:e.jsx(C,{className:"h-full border rounded-md overflow-y-auto",children:e.jsx(ca,{})})}),e.jsx("div",{className:"rounded-md",children:e.jsx(pa,{})}),e.jsx("div",{className:"rounded-md h-full overflow-y-auto overflow-x-auto bg-gray-800 border border-gray-600",children:e.jsx("pre",{className:"text-white whitespace-pre-wrap h-full p-4",children:e.jsx("code",{children:a?JSON.stringify(a==null?void 0:a.crd,null,2):"currentRow is undefined or null"})})})]})}),e.jsx($,{value:"jsondata",className:"h-[80vh] overflow-y-auto",children:e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(k,{children:a==null?void 0:a.crd.metadata.name}),e.jsxs(A,{children:["命名空间：",a==null?void 0:a.crd.metadata.namespace]})]}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-end mb-4",children:[t&&e.jsx(v,{variant:"ghost",onClick:h,children:"更新"}),e.jsx(v,{variant:"outline",onClick:()=>r(!t),children:t?"切换到视图模式":"切换到编辑模式"})]}),t?e.jsx(te,{value:d,onChange:D=>c(D.target.value),className:"min-h-[500px] font-mono",placeholder:"请输入JSON数据..."}):e.jsx(Fe,{src:(a==null?void 0:a.crd)||{},enableClipboard:!0,displayDataTypes:!1,name:!1})]})]})})]})})})}function Da({fetchData:s}){const{open:n,setOpen:a,currentRow:t,setCurrentRow:r,containerName:d,setContainerName:c}=q(),o=()=>{try{if(!(t!=null&&t.namespace)||!(t!=null&&t.name)){y({title:"更新失败",description:"缺少必要的Pod信息",variant:"destructive"});return}const h={group:"apps",version:"v1",resource:"daemonsets",namespace:t==null?void 0:t.namespace,name:t==null?void 0:t.name};fetch("/api/gvr",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}).then(f=>{if(!f.ok)throw new Error("刪除失败");return f.json()}).then(f=>{s(),y({title:"刪除成功",description:`Daemonset ${t.name} 配置已刪除`})}).catch(f=>{y({title:"刪除失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsx(fe,{open:n==="create",onOpenChange:()=>a("create")},"task-create"),e.jsx(ra,{open:n==="import",onOpenChange:()=>a("import")},"tasks-import"),t&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{open:n==="update",onOpenChange:()=>{a("update"),setTimeout(()=>{r(null)},500)},currentRow:t},`task-update-${t.id}`),e.jsx(ha,{open:n==="terminal",onOpenChange:()=>{a(null),c(void 0),setTimeout(()=>{r(null)},500)},podName:t.name,namespace:t.namespace,containerName:d},`pod-terminal-${t.name}`),e.jsx(Ca,{open:n==="detail",onOpenChange:()=>{a(null),setTimeout(()=>{r(null)},500)},currentRow:t},`pod-detail-${t.name}`),e.jsx(xa,{open:n==="ssh",onOpenChange:()=>{a(null),c(void 0),setTimeout(()=>{r(null)},500)},podName:t.name,namespace:t.namespace,containerName:d},`pod-ssh-${t.name}`),e.jsx(Ms,{destructive:!0,open:n==="delete",onOpenChange:()=>{a("delete"),setTimeout(()=>{r(null)},500)},handleConfirm:()=>{a(null),setTimeout(()=>{r(null)},500),o()},name:t.name,namespace:t.namespace,className:"max-w-md",title:`Delete DaemonSets: ${t.namespace}/${t.name} ?`,desc:e.jsxs(e.Fragment,{children:["You are about to delete a DaemonSets with the Name"," ",e.jsxs("strong",{children:[t.namespace,"/",t.name]}),". ",e.jsx("br",{}),"This action cannot be undone."]}),confirmText:"Delete"},"task-delete")]})]})}function Ta(){const[s,n]=N.useState([]),a=async()=>{try{const t=await V.post("/api/gvr/list",{group:"apps",version:"v1",resource:"daemonsets",fast:!0});n(t.data)}catch(t){y({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(t,null,2)})})})}};return N.useEffect(()=>{a()},[]),e.jsxs(Zs,{children:[e.jsxs(ps,{fixed:!0,children:[e.jsx(js,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(us,{}),e.jsx(fs,{})]})]}),e.jsx(gs,{children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-x-4 space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"DaemonSets"}),e.jsx("p",{className:"text-muted-foreground",children:"DaemonSets是Kubernetes中用于确保在每个节点上运行一个Pod的资源，确保在任何给定时间都有指定数量的Pods在运行。"})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0 mr-[1px]",children:e.jsx(na,{data:s,columns:Rs,fetchData:a})})]})}),e.jsx(Da,{fetchData:a})]})}const qa=Ns("/_authenticated/daemonsets/")({component:Ta});export{qa as Route};
