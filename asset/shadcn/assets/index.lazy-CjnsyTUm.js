import{j as e,d as J,Q as Y,R as de,B as f,V as Z,W as E,X as ce,r as v,Y as re,z as g,Z as be,D as ye,E as Se,J as De,K as Te,ag as Me,ah as ke,ai as Ie,s as Ae,_ as K,a9 as Oe,aa as Pe,ab as Fe,ac as Ee,ad as R,ae as ee,af as Je,I as V,b as Ve,t as ze,$ as Be,a0 as $e,a1 as He,a2 as Qe,a3 as Ue,F as _e,e as Ge,f as Ke,g as Le,h as qe,i as Xe,a4 as Ye,a8 as Ze,a5 as N,ao as oe,ap as me,aq as he,ar as xe,as as pe,at as je,au as ge,aD as We,a7 as ae,aE as k,C as z,ax as B,ay as $,az as H,aA as Q,aG as we,aH as Re,aI as P,aJ as L,aK as q,aL as F,H as ea,p as aa,T as sa,q as ta,M as ia,c as na}from"./index-B1ZXdEgv.js";import{C as se}from"./checkbox-BkUrLzJe.js";import{A as te,a as ie,C as la,E as da,D as ca,b as ra,c as oa,d as ma,e as ha,M as xa,P as pa,f as ja,g as ga}from"./react-icons.esm-DfBn7391.js";import{u as fa,I as Na,C as va}from"./confirm-dialog-C5unt0Mw.js";import{u as ua,T as U,a as _,b as M,c as I,f as ne,d as G,e as b,g as Ca,h as ba,i as ya,j as Sa,k as Da,l as Ta,m as Ma}from"./table-DqV8PWYy.js";import{S as ka,a as Ia,b as Aa,c as Oa,d as Pa}from"./select-BV3M1mNM.js";import{P as Fa,a as Ea,b as Ja}from"./popover-B8YD6lJu.js";import{I as Va}from"./IconDownload-BDAwYXfa.js";import{I as za}from"./IconPlus-BueD2YFF.js";import{T as X}from"./textarea-Bgp5JSYX.js";import{J as fe,D as W,a as w}from"./main-DLfVeK_1.js";import"./chart-Bl7wQTk0.js";import"./index-B9NU5RqY.js";function A({column:a,title:i,className:s}){return a.getCanSort()?e.jsx("div",{className:J("flex items-center space-x-2",s),children:e.jsxs(Y,{children:[e.jsx(de,{asChild:!0,children:e.jsxs(f,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:i}),a.getIsSorted()==="desc"?e.jsx(te,{className:"ml-2 h-4 w-4"}):a.getIsSorted()==="asc"?e.jsx(ie,{className:"ml-2 h-4 w-4"}):e.jsx(la,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(Z,{align:"start",children:[e.jsxs(E,{onClick:()=>a.toggleSorting(!1),children:[e.jsx(ie,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(E,{onClick:()=>a.toggleSorting(!0),children:[e.jsx(te,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),a.getCanHide()&&e.jsxs(e.Fragment,{children:[e.jsx(ce,{}),e.jsxs(E,{onClick:()=>a.toggleVisibility(!1),children:[e.jsx(da,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})]})}):e.jsx("div",{className:J(s),children:i})}const Ne=re.createContext(null);function Ba({children:a}){const[i,s]=fa(null),[t,l]=v.useState(null),[n,d]=v.useState(void 0);return e.jsx(Ne,{value:{open:i,setOpen:s,currentRow:t,setCurrentRow:l,containerName:n,setContainerName:d},children:a})}const O=()=>{const a=re.useContext(Ne);if(!a)throw new Error("useTasks has to be used within <PodsContext>");return a},$a=g.object({apiVersion:g.string(),kind:g.string(),metadata:g.object({name:g.string(),namespace:g.string().optional(),labels:g.record(g.string(),g.string()).optional(),annotations:g.record(g.string(),g.string()).optional(),creationTimestamp:g.string().optional(),resourceVersion:g.string().optional(),uid:g.string().optional()}).optional(),data:g.record(g.string(),g.string()).optional(),binaryData:g.record(g.string(),g.string()).optional(),immutable:g.boolean().optional()}),Ha=g.object({name:g.string(),namespace:g.string(),crd:$a});function Qa({row:a}){const i=Ha.parse(a.original),{setOpen:s,setCurrentRow:t}=O();return e.jsxs(Y,{modal:!1,children:[e.jsx(de,{asChild:!0,children:e.jsxs(f,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(ca,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsx(Z,{align:"end",className:"w-[160px]",children:e.jsxs(E,{onClick:()=>{t(i),s("delete")},children:["刪除",e.jsx(be,{children:e.jsx(Na,{size:16})})]})})]})}const Ua=[{id:"select",header:({table:a})=>e.jsx(se,{checked:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:i=>a.toggleAllPageRowsSelected(!!i),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:a})=>e.jsx(se,{checked:a.getIsSelected(),onCheckedChange:i=>a.toggleSelected(!!i),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:a})=>e.jsx(A,{column:a,title:"名称"}),cell:({row:a})=>{var l;const{setOpen:i,setCurrentRow:s}=O(),t=()=>{i("detail"),s(a.original)};return e.jsx("div",{children:e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap hover:overflow-visible hover:text-blue-600 cursor-pointer",onClick:t,children:(l=a.original)==null?void 0:l.name})})},enableSorting:!1,enableHiding:!1},{accessorKey:"namespace",header:({column:a})=>e.jsx(A,{column:a,title:"命名空间"}),cell:({row:a})=>{var i;return e.jsx("div",{className:"w-fit",children:(i=a.original)==null?void 0:i.namespace})}},{accessorKey:"data",header:({column:a})=>e.jsx(A,{column:a,title:"Data"}),cell:({row:a})=>{var i,s;return e.jsx("div",{className:"w-fit",children:(s=(i=a.original)==null?void 0:i.crd)!=null&&s.data?Object.keys(a.original.crd.data).length:"0"})}},{accessorKey:"capatibility",header:({column:a})=>e.jsx(A,{column:a,title:"大小"}),cell:({row:a})=>{var i,s;return e.jsx("div",{className:"w-fit",children:(s=(i=a.original)==null?void 0:i.crd)!=null&&s.data?(()=>{const t=Object.values(a.original.crd.data).reduce((l,n)=>l+((n==null?void 0:n.length)||0),0);return t>=1024*1024?(t/(1024*1024)).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t+" bytes"})():"0 bytes"})}},{accessorKey:"owner",header:({column:a})=>e.jsx(A,{column:a,title:"OwnerReferences"}),cell:({row:a})=>{var s,t,l;const i=(l=(t=(s=a.original)==null?void 0:s.crd)==null?void 0:t.metadata)==null?void 0:l.ownerReferences;return!i||i.length===0?"-":e.jsx(ye,{children:e.jsxs(Se,{children:[e.jsx(De,{className:"w-fit",children:i.map((n,d)=>e.jsx("div",{className:"text-ellipsis overflow-hidden whitespace-nowrap hover:overflow-visible hover:text-blue-600 cursor-pointer",children:`${n.kind}/${n.name}`},d))}),e.jsx(Te,{children:i.map((n,d)=>e.jsx("div",{children:`${n.kind}/${n.name}`},d))})]})})}},{accessorKey:"createtime",header:({column:a})=>e.jsx(A,{column:a,title:"运行时间"}),cell:({row:a})=>{var h;const i=c=>{const r=Date.now()-c,j=24*3600*1e3,p=3600*1e3,u=60*1e3,y=Math.floor(r/j),C=r%j,S=Math.floor(C/p),T=C%p,ve=Math.floor(T/u),ue=T%u,Ce=Math.round(ue/1e3);return{days:y,hours:S,minutes:ve,seconds:Ce}},s=(c,x,r,j)=>{let p="";return c>0&&(p+=`${c}d `),x>0&&(p+=`${x}h `),r>0&&(p+=`${r}m `),j>0&&(p+=`${j}s`),p},t=new Date(((h=a.original.crd.metadata)==null?void 0:h.creationTimestamp)||"").getTime(),{days:l,hours:n,minutes:d,seconds:o}=i(t),m=s(l,n,d,o);return e.jsx("div",{className:"w-fit",children:m})}},{id:"actions",cell:({row:a})=>e.jsx(Qa,{row:a})}];function _a({table:a}){return e.jsxs("div",{className:"flex items-center justify-between overflow-clip px-2",style:{overflowClipMargin:1},children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[a.getFilteredSelectedRowModel().rows.length," of"," ",a.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(ka,{value:`${a.getState().pagination.pageSize}`,onValueChange:i=>{a.setPageSize(Number(i))},children:[e.jsx(Ia,{className:"h-8 w-[70px]",children:e.jsx(Aa,{placeholder:a.getState().pagination.pageSize})}),e.jsx(Oa,{side:"top",children:[5,10,20,30,40,50].map(i=>e.jsx(Pa,{value:`${i}`,children:i},i))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",a.getState().pagination.pageIndex+1," of"," ",a.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(f,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(0),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(ra,{className:"h-4 w-4"})]}),e.jsxs(f,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.previousPage(),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(oa,{className:"h-4 w-4"})]}),e.jsxs(f,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.nextPage(),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(ma,{className:"h-4 w-4"})]}),e.jsxs(f,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(a.getPageCount()-1),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(ha,{className:"h-4 w-4"})]})]})]})]})}function Ga({table:a}){return e.jsxs(Y,{modal:!1,children:[e.jsx(Me,{asChild:!0,children:e.jsxs(f,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(xa,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(Z,{align:"end",className:"w-[150px]",children:[e.jsx(ke,{children:"Toggle columns"}),e.jsx(ce,{}),a.getAllColumns().filter(i=>typeof i.accessorFn<"u"&&i.getCanHide()).map(i=>e.jsx(Ie,{className:"capitalize",checked:i.getIsVisible(),onCheckedChange:s=>i.toggleVisibility(!!s),children:i.id},i.id))]})]})}function Ka({column:a,title:i,options:s}){const t=a==null?void 0:a.getFacetedUniqueValues(),l=new Set(a==null?void 0:a.getFilterValue());return e.jsxs(Fa,{children:[e.jsx(Ea,{asChild:!0,children:e.jsxs(f,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(pa,{className:"mr-2 h-4 w-4"}),i,(l==null?void 0:l.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ae,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(K,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:l.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:l.size>2?e.jsxs(K,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[l.size," selected"]}):s.filter(n=>l.has(n.value)).map(n=>e.jsx(K,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:n.label},n.value))})]})]})}),e.jsx(Ja,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Oe,{children:[e.jsx(Pe,{placeholder:i}),e.jsxs(Fe,{children:[e.jsx(Ee,{children:"No results found."}),e.jsx(R,{children:s.map(n=>{const d=l.has(n.value);return e.jsxs(ee,{onSelect:()=>{d?l.delete(n.value):l.add(n.value);const o=Array.from(l);a==null||a.setFilterValue(o.length?o:void 0)},children:[e.jsx("div",{className:J("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",d?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(ja,{className:J("h-4 w-4")})}),n.icon&&e.jsx(n.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:n.label}),(t==null?void 0:t.get(n.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:t.get(n.value)})]},n.value)})}),l.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx(R,{children:e.jsx(ee,{onSelect:()=>a==null?void 0:a.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}const La=({fetchData:a})=>{const{setOpen:i}=O();return e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",className:"space-x-1",onClick:()=>i("import"),children:[e.jsx("span",{children:"Import"})," ",e.jsx(Va,{size:18})]}),e.jsxs(f,{className:"space-x-1",variant:"outline",onClick:()=>i("create"),children:[e.jsx("span",{children:"Create"})," ",e.jsx(za,{size:18})]}),e.jsx(f,{onClick:a,variant:"outline",children:"刷新"})]})};function qa({table:a,originalData:i,fetchData:s}){var n;const t=a.getState().columnFilters.length>0,l=[...new Set(i.map(d=>{var o;return(o=d.crd)==null?void 0:o.metadata.namespace}))].map(d=>({value:d,label:d}));return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(V,{placeholder:"Filter tasks...",value:((n=a.getColumn("name"))==null?void 0:n.getFilterValue())??"",onChange:d=>{var o;return(o=a.getColumn("name"))==null?void 0:o.setFilterValue(d.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsx("div",{className:"flex gap-x-2",children:a.getColumn("namespace")&&e.jsx(Ka,{column:a.getColumn("namespace"),title:"命名空间筛选",options:l})}),t&&e.jsxs(f,{variant:"ghost",onClick:()=>a.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(ga,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(Ga,{table:a}),e.jsx(La,{fetchData:s})]})}function Xa({columns:a,data:i,fetchData:s}){var r;const[t,l]=v.useState({}),[n,d]=v.useState({}),[o,m]=v.useState([]),[h,c]=v.useState([]),x=ua({data:i,columns:a,state:{sorting:h,columnVisibility:n,rowSelection:t,columnFilters:o},enableRowSelection:!0,onRowSelectionChange:l,onSortingChange:c,onColumnFiltersChange:m,onColumnVisibilityChange:d,getCoreRowModel:Ta(),getFilteredRowModel:Da(),getPaginationRowModel:Sa(),getSortedRowModel:ya(),getFacetedRowModel:ba(),getFacetedUniqueValues:Ca()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(qa,{table:x,originalData:i,fetchData:s}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(U,{children:[e.jsx(_,{children:x.getHeaderGroups().map(j=>e.jsx(M,{children:j.headers.map(p=>e.jsx(I,{colSpan:p.colSpan,children:p.isPlaceholder?null:ne(p.column.columnDef.header,p.getContext())},p.id))},j.id))}),e.jsx(G,{children:(r=x.getRowModel().rows)!=null&&r.length?x.getRowModel().rows.map(j=>e.jsx(M,{"data-state":j.getIsSelected()&&"selected",children:j.getVisibleCells().map(p=>e.jsx(b,{children:ne(p.column.columnDef.cell,p.getContext())},p.id))},j.id)):e.jsx(M,{children:e.jsx(b,{colSpan:a.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(_a,{table:x})]})}const Ya=g.object({file:g.instanceof(FileList).refine(a=>a.length>0,{message:"Please upload a file"}).refine(a=>{var i;return["text/csv"].includes((i=a==null?void 0:a[0])==null?void 0:i.type)},"Please upload csv format.")});function Za({open:a,onOpenChange:i}){const s=Ve({resolver:ze(Ya),defaultValues:{file:void 0}}),t=s.register("file"),l=()=>{const n=s.getValues("file");if(n&&n[0]){const d={name:n[0].name,size:n[0].size,type:n[0].type};N({title:"You have imported the following file:",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(d,null,2)})})})}i(!1)};return e.jsx(Be,{open:a,onOpenChange:n=>{i(n),s.reset()},children:e.jsxs($e,{className:"gap-2 sm:max-w-sm",children:[e.jsxs(He,{className:"text-left",children:[e.jsx(Qe,{children:"Import Tasks"}),e.jsx(Ue,{children:"Import tasks quickly from a CSV file."})]}),e.jsx(_e,{...s,children:e.jsx("form",{id:"task-import-form",onSubmit:s.handleSubmit(l),children:e.jsx(Ge,{control:s.control,name:"file",render:()=>e.jsxs(Ke,{className:"mb-2 space-y-1",children:[e.jsx(Le,{children:"File"}),e.jsx(qe,{children:e.jsx(V,{type:"file",...t,className:"h-8"})}),e.jsx(Xe,{})]})})})}),e.jsxs(Ye,{className:"gap-2 sm:gap-0",children:[e.jsx(Ze,{asChild:!0,children:e.jsx(f,{variant:"outline",children:"Close"})}),e.jsx(f,{type:"submit",form:"task-import-form",children:"Import"})]})]})})}const Wa={apiVersion:"v1",kind:"ConfigMap",metadata:{annotations:{"cni.projectcalico.org/containerID":"6952a74e0b1c95f958e0e40eb2c8a8d93430112f2fc1860f2e81aa4d439d48e2","cni.projectcalico.org/podIP":"10.42.153.106/32","cni.projectcalico.org/podIPs":"10.42.153.106/32"},creationTimestamp:"2025-03-25T14:09:59Z",generateName:"demo-7fdf7d479b-",labels:{aa:"bbcd","app.kubernetes.io/instance":"demo","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"demo","app.kubernetes.io/version":"1.16.0","helm.sh/chart":"demo-0.1.0","pod-template-hash":"7fdf7d479b"},name:"demo-7fdf7d479b-g52kv",namespace:"default"},data:{"ca.crt":`-----BEGIN CERTIFICATE-----
MIIBeDCCAR+gAwIBAgIBADAKBggqhkjOPQQDAjAkMSIwIAYDVQQDDBlya2UyLXNl
cnZlci1jYUAxNzI5NTE3MDg2MB4XDTI0MTAyMTEzMjQ0NloXDTM0MTAxOTEzMjQ0
NlowJDEiMCAGA1UEAwwZcmtlMi1zZXJ2ZXItY2FAMTcyOTUxNzA4NjBZMBMGByqG
SM49AgEGCCqGSM49AwEHA0IABNKBzAGXLrClfDtJiqdWcQXRjazRk2Y07Xr1mTPX
GhNMJzZJZTrYMdbKQxreqDZuMk2YW17wRQAd/siTNViQ9hOjQjBAMA4GA1UdDwEB
/wQEAwICpDAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBRrtYwH+oUGoWFwYB02
BZHErOVJ7DAKBggqhkjOPQQDAgNHADBEAiAEQzDeiTNdp1rwwdoPlshuGe6aiau+
MKcs+FgeBI8XJQIgGIsQ9C5sMUjM72VQMEIyiX3ZrM5Q3A35+upuHxPaop8=
-----END CERTIFICATE-----
`}};function le({open:a,onOpenChange:i,currentRow:s}){const t=!!s,[l,n]=v.useState(""),[d,o]=v.useState(""),[m,h]=v.useState(!1);v.useEffect(()=>{s!=null&&s.raw&&n(JSON.stringify(s.raw,null,2)),o(JSON.stringify(Wa,null,2))},[s]);const c=()=>{try{if(!(s!=null&&s.namespace)||!(s!=null&&s.name)){N({title:"更新失败",description:"缺少必要的Pod信息",variant:"destructive"});return}const r={group:"",version:"v1",resource:"configmaps",namespace:s.namespace,name:s.name,data:JSON.parse(l)};fetch("/api/gvr",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(j=>{if(!j.ok)throw new Error("更新失败");return j.json()}).then(j=>{N({title:"更新成功",description:`ConfigMap ${s==null?void 0:s.name} 已更新`}),i(!1)}).catch(j=>{N({title:"更新失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{N({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}},x=()=>{try{const r=JSON.parse(d);r.metadata.name===""&&N({title:"缺少必要条件",description:"metdata.name 不能为空"});const j={group:"",version:"v1",resource:"configmaps",namespace:r.metadata.namespace===""?"default":r.metadata.namespace,name:r.metadata.name,data:r};fetch("/api/gvr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}).then(p=>{if(!p.ok)throw new Error("新增失败");return p.json()}).then(p=>{N({title:"新增成功",description:`ConfigMap ${r.metadata.name} 已新增`}),i(!1)}).catch(p=>{N({title:"新增失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{N({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsx(oe,{open:a,onOpenChange:r=>{i(r)},children:e.jsxs(me,{side:"right",className:"w-[50%] sm:max-w-[90%] flex flex-col overflow-y-auto",children:[e.jsxs(he,{className:"text-left",children:[e.jsxs(xe,{children:[t?"更新":"创建"," Pod"]}),e.jsx(pe,{children:t?"更新Pod配置信息":"创建新的Pod配置"})]}),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(f,{variant:"outline",onClick:()=>h(!m),children:m?"切换到视图模式":"切换到编辑模式"})}),m?e.jsx(X,{value:l,onChange:r=>n(r.target.value),className:"flex-1 font-mono resize-none",placeholder:"请输入JSON数据..."}):e.jsx(fe,{src:(s==null?void 0:s.raw)||{},enableClipboard:!0,displayDataTypes:!1,name:!1})]}):e.jsx(X,{value:d,onChange:r=>{o(r.target.value)},className:"flex-1 font-mono resize-none",placeholder:"请输入Pod配置..."}),e.jsxs(je,{className:"gap-2 mt-4",children:[e.jsx(ge,{asChild:!0,children:e.jsx(f,{variant:"outline",children:"关闭"})}),t?m&&e.jsx(f,{form:"tasks-form",onClick:c,children:"更新配置"}):e.jsx(f,{form:"tasks-form",onClick:x,children:"新建"})]})]})})}function wa({open:a,onOpenChange:i,podName:s,namespace:t,containerName:l}){const n=`/ws/logs/html/${t}/${s}/${l}`;return e.jsx(W,{open:a,onOpenChange:i,children:e.jsx(w,{className:"h-[80vh] mt-0",children:e.jsx("div",{className:"w-full h-full",children:e.jsx("iframe",{src:n,className:"w-full h-full rounded-md border",style:{minHeight:"500px"}})})})})}function Ra({open:a,onOpenChange:i,podName:s,namespace:t,containerName:l}){const n=`/ws/ssh/html/${t}/${s}/${l}`;return e.jsx(W,{open:a,onOpenChange:i,children:e.jsx(w,{className:"h-[80vh] mt-0",children:e.jsx("div",{className:"w-full h-full",children:e.jsx("iframe",{src:n,className:"w-full h-full rounded-md",style:{minHeight:"500px"}})})})})}function D({types:a,kind:i,name:s,namespace:t,keys:l,values:n}){const{currentRow:d,setCurrentRow:o}=O(),[m,h]=v.useState(""),[c,x]=v.useState(""),r=async()=>{if(!c||!m){N({title:"键或值不能为空",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:c,value:m},null,2)})})});return}try{if(i==="label"){const u=await k.patch("/api/gvr/patchstrate",{group:"",version:"v1",resource:"configmaps",name:s,namespace:t,patchdatastrate:{metadata:{labels:{[c]:m}}}}),y={...d,crd:u.data};o(y)}else if(i==="annotation"){const u=await k.patch("/api/gvr/patchstrate",{group:"",version:"v1",resource:"configmaps",name:s,namespace:t,patchdatastrate:{metadata:{annotations:{[c]:m}}}}),y={...d,crd:u.data};o(y)}else if(i==="data"){const u=await k.patch("/api/gvr/patchstrate",{group:"",version:"v1",resource:"configmaps",name:s,namespace:t,patchdatastrate:{data:{[c]:m}}}),y={...d,crd:u.data};o(y)}N({title:"请求成功",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:c,value:m},null,2)})})})}catch(u){N({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(u,null,2)})})})}},j=async()=>{var u,y;if(!c){N({title:"键不能为空",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:c},null,2)})})});return}if(window.confirm(`确定要删除键 ${c} 吗？`))try{if(i==="label"){const C={...d};(u=C.metadata)!=null&&u.labels&&delete C.metadata.labels[c];const S=await k.patch("/api/gvr/patchstrate",{group:"",version:"v1",resource:"configmaps",name:s,namespace:t,patchdatastrate:{metadata:{labels:{[c]:null}}}}),T={...d,crd:S.data};o(T)}else if(i==="annotation"){const C={...d};(y=C.metadata)!=null&&y.annotations&&delete C.metadata.annotations[c];const S=await k.patch("/api/gvr/patchstrate",{group:"",version:"v1",resource:"configmaps",name:s,namespace:t,patchdatastrate:{metadata:{annotations:{[c]:null}}}}),T={...d,crd:S.data};o(T)}else if(i==="data"){const C={...d};C.data&&delete C.data[c];const S=await k.patch("/api/gvr/patchstrate",{group:"",version:"v1",resource:"configmaps",name:s,namespace:t,patchdatastrate:{data:{[c]:null}}}),T={...d,crd:S.data};o(T)}N({title:"删除成功",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify({key:c,value:m},null,2)})})})}catch(C){N({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(C,null,2)})})})}};v.useEffect(()=>{h(n),x(l)},[n,l]);const p=()=>{a==="add"||a==="edit"?r():a==="delete"&&j()};return e.jsxs(oe,{children:[e.jsx(We,{asChild:!0,children:a==="edit"?e.jsx(f,{size:"sm",variant:"link",className:"w-20 text-blue-300 hover:text-blue-500",onClick:r,children:"编辑"}):a==="delete"?e.jsx(f,{size:"sm",variant:"link",className:"w-20 text-red-300 hover:text-red-500",onClick:j,children:"删除"}):a==="add"?e.jsx(f,{size:"sm",variant:"link",className:"w-20 text-green-300 hover:text-green-500",onClick:r,children:"添加"}):null}),e.jsxs(me,{side:"top",children:[e.jsxs(he,{children:[e.jsxs(xe,{children:[a==="edit"?"编辑":a==="add"?"添加":a==="delete"?"删除":null," 节点 ",s," ",i==="label"?"标签":i==="annotation"?"注释":""]}),e.jsxs(pe,{children:["新增节点 ",s," ",i==="label"?"标签":i==="annotation"?"注释":"","，请填写相关信息。",a==="edit"?"编辑节点":a==="add"?"添加节点":a==="delete"?"删除节点":null," ",s," ",i==="label"?"标签":i==="annotation"?"注释":"","，请填写相关信息。"]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(ae,{htmlFor:"name",className:"text-right",children:"键"}),e.jsx(V,{id:"name",value:c,disabled:a!=="add",onChange:u=>x(u.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(ae,{htmlFor:"username",className:"text-right",children:"值"}),e.jsx(V,{id:"username",value:m,onChange:u=>h(u.target.value),className:"col-span-3"})]})]}),e.jsx(je,{children:e.jsx(ge,{asChild:!0,children:e.jsx(f,{type:"submit",onClick:p,children:"提交"})})})]})]})}function es({currentRow:a}){const i=v.useMemo(()=>!a||!a.crd||!a.crd.data?[]:Object.entries(a.crd.data).map(([t,l])=>{var n,d,o,m,h,c,x,r;return e.jsxs(M,{children:[e.jsx(b,{className:"font-medium",children:t}),e.jsx(b,{className:"font-medium",children:l}),e.jsx(b,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(D,{types:"edit",kind:"data",name:((d=(n=a==null?void 0:a.crd)==null?void 0:n.metadata)==null?void 0:d.name)||"",namespace:((m=(o=a==null?void 0:a.crd)==null?void 0:o.metadata)==null?void 0:m.namespace)||"",keys:t,values:typeof l=="string"?l:""}),e.jsx(D,{types:"delete",kind:"data",name:((c=(h=a==null?void 0:a.crd)==null?void 0:h.metadata)==null?void 0:c.name)||"",namespace:((r=(x=a==null?void 0:a.crd)==null?void 0:x.metadata)==null?void 0:r.namespace)||"",keys:t,values:typeof l=="string"?l:""})]})})]},`${t}`)}),[a]),s=v.useMemo(()=>!a||!a.crd||!a.crd.binaryData?[]:Object.entries(a.crd.binaryData).map(([t,l])=>{var n,d,o,m,h,c,x,r;return e.jsxs(M,{children:[e.jsx(b,{className:"font-medium",children:t}),e.jsx(b,{className:"font-medium",children:l}),e.jsx(b,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(D,{types:"edit",kind:"data",name:((d=(n=a==null?void 0:a.crd)==null?void 0:n.metadata)==null?void 0:d.name)||"",namespace:((m=(o=a==null?void 0:a.crd)==null?void 0:o.metadata)==null?void 0:m.namespace)||"",keys:t,values:typeof l=="string"?l:""}),e.jsx(D,{types:"delete",kind:"data",name:((c=(h=a==null?void 0:a.crd)==null?void 0:h.metadata)==null?void 0:c.name)||"",namespace:((r=(x=a==null?void 0:a.crd)==null?void 0:x.metadata)==null?void 0:r.namespace)||"",keys:t,values:typeof l=="string"?l:""})]})})]},`${t}`)}),[a]);return e.jsxs(z,{children:[e.jsxs(B,{children:[e.jsxs($,{children:[a==null?void 0:a.crd.metadata.name,e.jsx(D,{types:"add",kind:"data",name:a?a.crd.metadata.name:"",namespace:a?a.crd.metadata.namespace:"",keys:"",values:""})]}),e.jsxs(H,{children:["命名空间：",a==null?void 0:a.crd.metadata.namespace]})]}),e.jsx(Q,{className:"space-y-2",children:e.jsxs(U,{children:[e.jsx(Ma,{children:"容器详情"}),e.jsx(_,{children:e.jsxs(M,{children:[e.jsx(I,{children:"Name"}),e.jsx(I,{children:"Data"})]})}),e.jsxs(G,{children:[i,s]})]})})]})}function as({currentRow:a}){const i=v.useMemo(()=>!a||!a.crd||!a.crd.metadata.labels?[]:Object.entries(a.crd.metadata.labels).map(([s,t])=>{var l,n,d,o,m,h,c,x;return e.jsxs(M,{children:[e.jsx(b,{className:"font-medium",children:s}),e.jsx(b,{children:t}),e.jsx(b,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(D,{types:"edit",kind:"label",name:((n=(l=a==null?void 0:a.crd)==null?void 0:l.metadata)==null?void 0:n.name)||"",namespace:((o=(d=a==null?void 0:a.crd)==null?void 0:d.metadata)==null?void 0:o.namespace)||"",keys:s,values:typeof t=="string"?t:""}),e.jsx(D,{types:"delete",kind:"label",name:((h=(m=a==null?void 0:a.crd)==null?void 0:m.metadata)==null?void 0:h.name)||"",namespace:((x=(c=a==null?void 0:a.crd)==null?void 0:c.metadata)==null?void 0:x.namespace)||"",keys:s,values:typeof t=="string"?t:""})]})})]},s)}),[a]);return e.jsxs(z,{children:[e.jsxs(B,{children:[e.jsxs($,{children:[a==null?void 0:a.crd.metadata.name,e.jsx(D,{types:"add",kind:"label",name:a?a.crd.metadata.name:"",namespace:a?a.crd.metadata.namespace:"",keys:"",values:""})]}),e.jsxs(H,{children:["命名空间：",a==null?void 0:a.crd.metadata.namespace]})]}),e.jsx(Q,{className:"space-y-2",children:e.jsxs(U,{children:[e.jsx(_,{children:e.jsxs(M,{children:[e.jsx(I,{className:"w-[50%]",children:"键"}),e.jsx(I,{className:"w-[50%]",children:"值"})]})}),e.jsx(G,{children:i})]})})]})}function ss({currentRow:a}){const i=v.useMemo(()=>!a||!a.crd||!a.crd.metadata.annotations?[]:Object.entries(a.crd.metadata.annotations).map(([s,t])=>{var l,n,d,o,m,h,c,x;return e.jsxs(M,{children:[e.jsx(b,{className:"font-medium",children:s}),e.jsx(b,{children:t}),e.jsx(b,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(D,{types:"edit",kind:"annotation",name:((n=(l=a==null?void 0:a.crd)==null?void 0:l.metadata)==null?void 0:n.name)||"",namespace:((o=(d=a==null?void 0:a.crd)==null?void 0:d.metadata)==null?void 0:o.namespace)||"",keys:s,values:typeof t=="string"?t:""}),e.jsx(D,{types:"delete",kind:"annotation",name:((h=(m=a==null?void 0:a.crd)==null?void 0:m.metadata)==null?void 0:h.name)||"",namespace:((x=(c=a==null?void 0:a.crd)==null?void 0:c.metadata)==null?void 0:x.namespace)||"",keys:s,values:typeof t=="string"?t:""})]})})]},s)}),[a]);return e.jsxs(z,{children:[e.jsxs(B,{children:[e.jsxs($,{children:[a==null?void 0:a.crd.metadata.name,e.jsx(D,{types:"add",kind:"annotation",name:a?a.crd.metadata.name:"",namespace:a?a.crd.metadata.namespace:"",keys:"",values:""})]}),e.jsxs(H,{children:["命名空间：",a==null?void 0:a.crd.metadata.namespace]})]}),e.jsx(Q,{className:"space-y-2",children:e.jsxs(U,{children:[e.jsx(_,{children:e.jsxs(M,{children:[e.jsx(I,{className:"w-[50%]",children:"键"}),e.jsx(I,{className:"w-[50%]",children:"值"})]})}),e.jsx(G,{children:i})]})})]})}function ts({open:a,onOpenChange:i,currentRow:s}){var h,c,x,r;const[t,l]=v.useState(!1),[n,d]=v.useState(""),{setCurrentRow:o}=O();v.useEffect(()=>{s!=null&&s.crd&&d(JSON.stringify(s.crd,null,2))},[s]);const m=()=>{var j,p,u,y;try{const C={group:"",version:"v1",resource:"configmaps",namespace:(p=(j=s==null?void 0:s.crd)==null?void 0:j.metadata)==null?void 0:p.namespace,name:(y=(u=s==null?void 0:s.crd)==null?void 0:u.metadata)==null?void 0:y.name,data:t?JSON.parse(n):s==null?void 0:s.crd};fetch("/api/gvr",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}).then(S=>S.json()).then(S=>{const T={...s,crd:S.data};o(T),N({title:"更新成功",description:`ConfigMap ${s==null?void 0:s.crd.metadata.name} 已更新`})}).catch(S=>{N({title:"更新失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{N({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsx(W,{open:a,onOpenChange:i,children:e.jsx(w,{children:e.jsxs(we,{defaultValue:"container",className:"w-full",children:[e.jsxs(Re,{className:"grid w-full grid-cols-4 gap-2",children:[e.jsxs(P,{value:"container",children:["配置",e.jsx(L,{className:"h-5 w-5 ml-1",children:e.jsx(q,{className:"text-xs",children:Object.keys(s.crd.data||{}).length})})]}),e.jsxs(P,{value:"label",children:["标签",e.jsx(L,{className:"h-5 w-5 ml-1",children:e.jsx(q,{className:"text-xs",children:(c=(h=s==null?void 0:s.crd)==null?void 0:h.metadata)!=null&&c.labels?Object.keys(s.crd.metadata.labels).length:0})})]}),e.jsxs(P,{value:"annotation",children:["注释",e.jsx(L,{className:"h-5 w-5 ml-1",children:e.jsx(q,{className:"text-xs",children:(r=(x=s==null?void 0:s.crd)==null?void 0:x.metadata)!=null&&r.annotations?Object.keys(s.crd.metadata.annotations).length:0})})]}),e.jsx(P,{value:"jsondata",children:"查看或编辑"})]}),e.jsx(F,{value:"label",className:"h-[80vh] overflow-y-auto",children:e.jsx(as,{currentRow:s})}),e.jsx(F,{value:"annotation",className:"h-[80vh] overflow-y-auto",children:e.jsx(ss,{currentRow:s})}),e.jsx(F,{value:"container",className:"h-[80vh] overflow-y-auto",children:e.jsx(es,{currentRow:s})}),e.jsx(F,{value:"jsondata",className:"h-[80vh] overflow-y-auto",children:e.jsxs(z,{children:[e.jsxs(B,{children:[e.jsx($,{children:s==null?void 0:s.crd.metadata.name}),e.jsxs(H,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsxs(Q,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-end mb-4",children:[t&&e.jsx(f,{variant:"ghost",onClick:m,children:"更新"}),e.jsx(f,{variant:"outline",onClick:()=>l(!t),children:t?"切换到视图模式":"切换到编辑模式"})]}),t?e.jsx(X,{value:n,onChange:j=>d(j.target.value),className:"min-h-[500px] font-mono",placeholder:"请输入JSON数据..."}):e.jsx(fe,{src:(s==null?void 0:s.crd)||{},enableClipboard:!0,displayDataTypes:!1,name:!1})]})]})})]})})})}function is({fetchData:a}){const{open:i,setOpen:s,currentRow:t,setCurrentRow:l,containerName:n,setContainerName:d}=O(),o=()=>{try{if(!(t!=null&&t.namespace)||!(t!=null&&t.name)){N({title:"更新失败",description:"缺少必要的Pod信息",variant:"destructive"});return}const m={group:"",version:"v1",resource:"configmaps",namespace:t==null?void 0:t.namespace,name:t==null?void 0:t.name};fetch("/api/gvr",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(h=>{if(!h.ok)throw new Error("刪除失败");return h.json()}).then(h=>{a(),N({title:"刪除成功",description:`ConfigMap ${t==null?void 0:t.name}已刪除`})}).catch(h=>{N({title:"刪除失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{N({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsx(le,{open:i==="create",onOpenChange:()=>s("create")},"task-create"),e.jsx(Za,{open:i==="import",onOpenChange:()=>s("import")},"tasks-import"),t&&e.jsxs(e.Fragment,{children:[e.jsx(le,{open:i==="update",onOpenChange:()=>{s("update"),setTimeout(()=>{l(null)},500)},currentRow:t},`task-update-${t.id}`),e.jsx(wa,{open:i==="terminal",onOpenChange:()=>{s(null),d(void 0),setTimeout(()=>{l(null)},500)},podName:t.name,namespace:t.namespace,containerName:n},`pod-terminal-${t.name}`),e.jsx(ts,{open:i==="detail",onOpenChange:()=>{s(null),setTimeout(()=>{l(null)},500)},currentRow:t},`pod-detail-${t.name}`),e.jsx(Ra,{open:i==="ssh",onOpenChange:()=>{s(null),d(void 0),setTimeout(()=>{l(null)},500)},podName:t.name,namespace:t.namespace,containerName:n},`pod-ssh-${t.name}`),e.jsx(va,{destructive:!0,open:i==="delete",onOpenChange:()=>{s("delete"),setTimeout(()=>{l(null)},500)},handleConfirm:()=>{s(null),setTimeout(()=>{l(null)},500),o()},name:t.name,namespace:t.namespace,className:"max-w-md",title:`Delete ConfigMap: ${t.namespace}/${t.name} ?`,desc:e.jsxs(e.Fragment,{children:["You are about to delete a ConfigMap with the Name"," ",e.jsxs("strong",{children:[t.namespace,"/",t.name]}),". ",e.jsx("br",{}),"This action cannot be undone."]}),confirmText:"Delete"},"task-delete")]})]})}function ns(){const[a,i]=v.useState([]),s=async()=>{try{const t=await k.post("/api/gvr/list",{group:"",version:"v1",resource:"configmaps",fast:!0});i(t.data)}catch(t){N({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(t,null,2)})})})}};return v.useEffect(()=>{s()},[]),e.jsxs(Ba,{children:[e.jsxs(ea,{fixed:!0,children:[e.jsx(aa,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(sa,{}),e.jsx(ta,{})]})]}),e.jsx(ia,{children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-x-4 space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"ConfigMap"}),e.jsx("p",{className:"text-muted-foreground",children:"ConfigMap是Kubernetes中用于存储非机密数据的API对象。它允许用户将配置数据分离到独立的对象中，从而使应用程序和服务能够更灵活地使用这些配置。ConfigMap可以存储键值对、文件或目录等数据，并可以在Pod中以环境变量、命令行参数或挂载为文件的方式使用。通过ConfigMap，用户可以轻松地管理和更新应用程序的配置，而无需重新构建镜像或修改代码。"}),e.jsx("p",{className:"text-muted-foreground",children:"通过使用ConfigMap，用户可以将配置与应用程序代码分离，从而实现更好的可维护性和灵活性。ConfigMap支持动态更新，允许在不重启Pod的情况下更新配置。"})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0 mr-[1px]",children:e.jsx(Xa,{data:a,columns:Ua,fetchData:s})})]})}),e.jsx(is,{fetchData:s})]})}const vs=na("/_authenticated/configmaps/")({component:ns});export{vs as Route};
