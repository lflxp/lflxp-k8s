import{j as e,d as K,Q as Ne,R as Ee,B as u,V as ve,W as Z,X as ye,r as g,Y as be,D as Se,E as Ce,J as De,K as Te,ag as Je,ah as Ve,ai as $e,s as ze,_ as A,a9 as He,aa as _e,ab as Ue,ac as qe,ad as de,ae as re,af as Ke,I as ee,b as Le,t as we,z as ce,$ as Be,a0 as Ge,a1 as Ye,a2 as We,a3 as Qe,F as Xe,e as Ze,f as Re,g as es,h as ss,i as as,a4 as is,a8 as ns,a5 as y,ax as ls,ay as oe,C as b,az as S,aA as C,aB as D,aC as T,a7 as me,aD as U,ao as ts,ap as ds,aq as rs,ar as cs,as as os,at as ms,au as xs,aE as G,aF as L,aH as ke,aI as hs,aJ as js,aK as I,aL as Y,aM as W,aN as M,H as ps,p as fs,T as gs,q as us,M as Ns,c as vs}from"./index-C8RBtD9j.js";import{C as xe}from"./checkbox-B-BNqKjZ.js";import{A as he,a as je,C as ys,E as bs,b as Ss,c as Cs,d as Ds,e as Ts,M as ks,P as Ps,f as Os,g as Is}from"./react-icons.esm-Bw71x8l6.js";import{u as Ms,C as Fs}from"./confirm-dialog-DvVAAfR-.js";import{u as As,T as k,a as P,b as h,c as o,f as pe,d as O,e as d,g as Es,h as Js,i as Vs,j as $s,k as zs,l as Hs,m as _s}from"./table-C_DkmO8U.js";import{S as Pe,a as Oe,b as Ie,c as Me,d as q}from"./select-B72FxWQM.js";import{P as Us,a as qs,b as Ks}from"./popover-Bk_Oen4F.js";import{I as Ls}from"./IconDownload-Bo2jmdvU.js";import{I as ws}from"./IconPlus-zVN9k3Fl.js";import{T as R}from"./textarea-CUkeIa7P.js";import{D as se,a as ae}from"./drawer-D3ee4Bmv.js";import{C as Bs,I as H,a as fe,M as w}from"./chart-Bxip7_qU.js";import{J as Fe,R as Gs}from"./main-D7ihrZsr.js";import"./index-BeTzKkUk.js";function _({column:s,title:n,className:a}){return s.getCanSort()?e.jsx("div",{className:K("flex items-center space-x-2",a),children:e.jsxs(Ne,{children:[e.jsx(Ee,{asChild:!0,children:e.jsxs(u,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:n}),s.getIsSorted()==="desc"?e.jsx(he,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(je,{className:"ml-2 h-4 w-4"}):e.jsx(ys,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ve,{align:"start",children:[e.jsxs(Z,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(je,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(Z,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(he,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),s.getCanHide()&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{}),e.jsxs(Z,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(bs,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})]})}):e.jsx("div",{className:K(a),children:n})}const Ae=be.createContext(null);function Ys({children:s}){const[n,a]=Ms(null),[i,l]=g.useState(null),[t,m]=g.useState(void 0);return e.jsx(Ae,{value:{open:n,setOpen:a,currentRow:i,setCurrentRow:l,containerName:t,setContainerName:m},children:s})}const Q=()=>{const s=be.useContext(Ae);if(!s)throw new Error("useTasks has to be used within <PodsContext>");return s},Ws=[{id:"select",header:({table:s})=>e.jsx(xe,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:n=>s.toggleAllPageRowsSelected(!!n),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(xe,{checked:s.getIsSelected(),onCheckedChange:n=>s.toggleSelected(!!n),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:s})=>e.jsx(_,{column:s,title:"名称"}),cell:({row:s})=>{var l;const{setOpen:n,setCurrentRow:a}=Q(),i=()=>{n("detail"),console.log("row",s.original),a(s.original)};return e.jsx("div",{children:e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap hover:overflow-visible hover:text-blue-600 cursor-pointer",onClick:i,children:(l=s.original)==null?void 0:l.name})})},enableSorting:!1,enableHiding:!1},{accessorKey:"namespace",header:({column:s})=>e.jsx(_,{column:s,title:"命名空间"}),cell:({row:s})=>{var n;return e.jsx("div",{className:"w-fit",children:(n=s.original)==null?void 0:n.namespace})}},{accessorKey:"images",header:({column:s})=>e.jsx(_,{column:s,title:"镜像"}),cell:({row:s})=>{var i,l,t,m,r;const a=(((r=(m=(t=(l=(i=s.original)==null?void 0:i.crd)==null?void 0:l.spec)==null?void 0:t.template)==null?void 0:m.spec)==null?void 0:r.containers)||[]).map(c=>c.image);return a.length===0?e.jsx("div",{children:"-"}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(Se,{children:e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx("div",{className:"max-w-[200px] truncate",children:a[0]})}),e.jsx(Te,{className:"max-w-[400px] whitespace-pre-wrap",children:a.map((c,f)=>e.jsx("div",{children:c},f))})]})}),a.length>1&&e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground",children:["+",a.length-1," more"]})]})},enableHiding:!0},{accessorKey:"ready",header:({column:s})=>e.jsx(_,{column:s,title:"就绪容器"}),cell:({row:s})=>{var l,t;const n=((l=s.original.status)==null?void 0:l.unavailableReplicas)||0,a=((t=s.original.status)==null?void 0:t.availableReplicas)||0,i=()=>{const m=[];for(let r=0;r<a;r++)m.push(e.jsx("span",{className:"bg-green-500 w-3 h-3 inline-block mr-1"},r));for(let r=0;r<n;r++)m.push(e.jsx("span",{className:"bg-gray-300 w-3 h-3 inline-block mr-1"},r+a));return m};return e.jsx("div",{className:"w-fit",children:i()})}},{accessorKey:"createtime",header:({column:s})=>e.jsx(_,{column:s,title:"运行时间"}),cell:({row:s})=>{const n=f=>{const j=Date.now()-f,x=24*3600*1e3,p=3600*1e3,N=60*1e3,J=Math.floor(j/x),F=j%x,V=Math.floor(F/p),E=F%p,$=Math.floor(E/N),B=E%N,z=Math.round(B/1e3);return{days:J,hours:V,minutes:$,seconds:z}},a=(f,v,j,x)=>{let p="";return f>0&&(p+=`${f}d `),v>0&&(p+=`${v}h `),j>0&&(p+=`${j}m `),x>0&&(p+=`${x}s`),p},i=new Date(s.getValue("createtime")).getTime(),{days:l,hours:t,minutes:m,seconds:r}=n(i),c=a(l,t,m,r);return e.jsx("div",{className:"w-fit",children:c})}}];function Qs({table:s}){return e.jsxs("div",{className:"flex items-center justify-between overflow-clip px-2",style:{overflowClipMargin:1},children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(Pe,{value:`${s.getState().pagination.pageSize}`,onValueChange:n=>{s.setPageSize(Number(n))},children:[e.jsx(Oe,{className:"h-8 w-[70px]",children:e.jsx(Ie,{placeholder:s.getState().pagination.pageSize})}),e.jsx(Me,{side:"top",children:[5,10,20,30,40,50].map(n=>e.jsx(q,{value:`${n}`,children:n},n))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(u,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(Ss,{className:"h-4 w-4"})]}),e.jsxs(u,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(Cs,{className:"h-4 w-4"})]}),e.jsxs(u,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(Ds,{className:"h-4 w-4"})]}),e.jsxs(u,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(Ts,{className:"h-4 w-4"})]})]})]})]})}function Xs({table:s}){return e.jsxs(Ne,{modal:!1,children:[e.jsx(Je,{asChild:!0,children:e.jsxs(u,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(ve,{align:"end",className:"w-[150px]",children:[e.jsx(Ve,{children:"Toggle columns"}),e.jsx(ye,{}),s.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()).map(n=>e.jsx($e,{className:"capitalize",checked:n.getIsVisible(),onCheckedChange:a=>n.toggleVisibility(!!a),children:n.id},n.id))]})]})}function Zs({column:s,title:n,options:a}){const i=s==null?void 0:s.getFacetedUniqueValues(),l=new Set(s==null?void 0:s.getFilterValue());return e.jsxs(Us,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(u,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(Ps,{className:"mr-2 h-4 w-4"}),n,(l==null?void 0:l.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(ze,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(A,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:l.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:l.size>2?e.jsxs(A,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[l.size," selected"]}):a.filter(t=>l.has(t.value)).map(t=>e.jsx(A,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:t.label},t.value))})]})]})}),e.jsx(Ks,{className:"w-[200px] p-0",align:"start",children:e.jsxs(He,{children:[e.jsx(_e,{placeholder:n}),e.jsxs(Ue,{children:[e.jsx(qe,{children:"No results found."}),e.jsx(de,{children:a.map(t=>{const m=l.has(t.value);return e.jsxs(re,{onSelect:()=>{m?l.delete(t.value):l.add(t.value);const r=Array.from(l);s==null||s.setFilterValue(r.length?r:void 0)},children:[e.jsx("div",{className:K("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",m?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Os,{className:K("h-4 w-4")})}),t.icon&&e.jsx(t.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:t.label}),(i==null?void 0:i.get(t.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:i.get(t.value)})]},t.value)})}),l.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ke,{}),e.jsx(de,{children:e.jsx(re,{onSelect:()=>s==null?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}const Rs=({fetchData:s})=>{const{setOpen:n}=Q();return e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",className:"space-x-1",onClick:()=>n("import"),children:[e.jsx("span",{children:"Import"})," ",e.jsx(Ls,{size:18})]}),e.jsxs(u,{className:"space-x-1",variant:"outline",onClick:()=>n("create"),children:[e.jsx("span",{children:"Create"})," ",e.jsx(ws,{size:18})]}),e.jsx(u,{onClick:s,variant:"outline",children:"刷新"})]})};function ea({table:s,originalData:n,fetchData:a}){var t;const i=s.getState().columnFilters.length>0;console.log("originalData",n);const l=[...new Set(n.map(m=>{var r;return(r=m.crd)==null?void 0:r.metadata.namespace}))].map(m=>({value:m,label:m}));return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(ee,{placeholder:"Filter tasks...",value:((t=s.getColumn("name"))==null?void 0:t.getFilterValue())??"",onChange:m=>{var r;return(r=s.getColumn("name"))==null?void 0:r.setFilterValue(m.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsx("div",{className:"flex gap-x-2",children:s.getColumn("namespace")&&e.jsx(Zs,{column:s.getColumn("namespace"),title:"命名空间筛选",options:l})}),i&&e.jsxs(u,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(Is,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(Xs,{table:s}),e.jsx(Rs,{fetchData:a})]})}function sa({columns:s,data:n,fetchData:a}){var x;const[i,l]=g.useState({}),[t,m]=g.useState({}),[r,c]=g.useState([]),[f,v]=g.useState([]),j=As({data:n,columns:s,state:{sorting:f,columnVisibility:t,rowSelection:i,columnFilters:r},enableRowSelection:!0,onRowSelectionChange:l,onSortingChange:v,onColumnFiltersChange:c,onColumnVisibilityChange:m,getCoreRowModel:Hs(),getFilteredRowModel:zs(),getPaginationRowModel:$s(),getSortedRowModel:Vs(),getFacetedRowModel:Js(),getFacetedUniqueValues:Es()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(ea,{table:j,originalData:n,fetchData:a}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(k,{children:[e.jsx(P,{children:j.getHeaderGroups().map(p=>e.jsx(h,{children:p.headers.map(N=>e.jsx(o,{colSpan:N.colSpan,children:N.isPlaceholder?null:pe(N.column.columnDef.header,N.getContext())},N.id))},p.id))}),e.jsx(O,{children:(x=j.getRowModel().rows)!=null&&x.length?j.getRowModel().rows.map(p=>e.jsx(h,{"data-state":p.getIsSelected()&&"selected",children:p.getVisibleCells().map(N=>e.jsx(d,{children:pe(N.column.columnDef.cell,N.getContext())},N.id))},p.id)):e.jsx(h,{children:e.jsx(d,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(Qs,{table:j})]})}const aa=ce.object({file:ce.instanceof(FileList).refine(s=>s.length>0,{message:"Please upload a file"}).refine(s=>{var n;return["text/csv"].includes((n=s==null?void 0:s[0])==null?void 0:n.type)},"Please upload csv format.")});function ia({open:s,onOpenChange:n}){const a=Le({resolver:we(aa),defaultValues:{file:void 0}}),i=a.register("file"),l=()=>{const t=a.getValues("file");if(t&&t[0]){const m={name:t[0].name,size:t[0].size,type:t[0].type};y({title:"You have imported the following file:",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(m,null,2)})})})}n(!1)};return e.jsx(Be,{open:s,onOpenChange:t=>{n(t),a.reset()},children:e.jsxs(Ge,{className:"gap-2 sm:max-w-sm",children:[e.jsxs(Ye,{className:"text-left",children:[e.jsx(We,{children:"Import Tasks"}),e.jsx(Qe,{children:"Import tasks quickly from a CSV file."})]}),e.jsx(Xe,{...a,children:e.jsx("form",{id:"task-import-form",onSubmit:a.handleSubmit(l),children:e.jsx(Ze,{control:a.control,name:"file",render:()=>e.jsxs(Re,{className:"mb-2 space-y-1",children:[e.jsx(es,{children:"File"}),e.jsx(ss,{children:e.jsx(ee,{type:"file",...i,className:"h-8"})}),e.jsx(as,{})]})})})}),e.jsxs(is,{className:"gap-2 sm:gap-0",children:[e.jsx(ns,{asChild:!0,children:e.jsx(u,{variant:"outline",children:"Close"})}),e.jsx(u,{type:"submit",form:"task-import-form",children:"Import"})]})]})})}const na=new Map([["Running","bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],["Failed","bg-neutral-300/40 border-neutral-300"],["Unknown","bg-sky-200/40 text-sky-900 dark:text-sky-100 border-sky-300"],["Successed","bg-destructive/10 dark:bg-destructive/50 text-destructive dark:text-primary border-destructive/10"],["Pending","bg-purple-200/40 text-purple-900 dark:text-purple-100 border-purple-300"]]),la=[{month:"January",desktop:186,mobile:80},{month:"February",desktop:305,mobile:200},{month:"March",desktop:237,mobile:120},{month:"April",desktop:73,mobile:190},{month:"May",desktop:209,mobile:130},{month:"June",desktop:214,mobile:140}],ta={desktop:{label:"Desktop",color:"#2563eb"},mobile:{label:"Mobile",color:"#60a5fa"}};function da(){return e.jsxs(e.Fragment,{children:[e.jsx(Bs,{config:ta,className:"min-h-[200px] w-full",children:e.jsxs(ls,{accessibilityLayer:!0,data:la,children:[e.jsx(oe,{dataKey:"desktop",fill:"var(--color-desktop)",radius:4}),e.jsx(oe,{dataKey:"mobile",fill:"var(--color-mobile)",radius:4})]})}),e.jsxs(b,{className:"h-full border rounded-md",children:[e.jsxs(S,{children:[e.jsx(C,{children:"Create project"}),e.jsx(D,{children:"Deploy your new project in one-click."})]}),e.jsx(T,{children:e.jsx("form",{children:e.jsxs("div",{className:"grid w-full items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx(me,{htmlFor:"name",children:"Name"}),e.jsx(ee,{id:"name",placeholder:"Name of your project"})]}),e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx(me,{htmlFor:"framework",children:"Framework"}),e.jsxs(Pe,{children:[e.jsx(Oe,{id:"framework",children:e.jsx(Ie,{placeholder:"Select"})}),e.jsxs(Me,{position:"popper",children:[e.jsx(q,{value:"next",children:"Next.js"}),e.jsx(q,{value:"sveltekit",children:"SvelteKit"}),e.jsx(q,{value:"astro",children:"Astro"}),e.jsx(q,{value:"nuxt",children:"Nuxt.js"})]})]})]})]})})}),e.jsxs(U,{className:"flex justify-between",children:[e.jsx(u,{variant:"outline",children:"Cancel"}),e.jsx(u,{children:"Deploy"})]})]})]})}const ra={apiVersion:"v1",kind:"Pod",metadata:{annotations:{"cni.projectcalico.org/containerID":"6952a74e0b1c95f958e0e40eb2c8a8d93430112f2fc1860f2e81aa4d439d48e2","cni.projectcalico.org/podIP":"10.42.153.106/32","cni.projectcalico.org/podIPs":"10.42.153.106/32"},creationTimestamp:"2025-03-25T14:09:59Z",generateName:"demo-7fdf7d479b-",labels:{aa:"bbcd","app.kubernetes.io/instance":"demo","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"demo","app.kubernetes.io/version":"1.16.0","helm.sh/chart":"demo-0.1.0","pod-template-hash":"7fdf7d479b"},name:"demo-7fdf7d479b-g52kv",namespace:"default"},spec:{containers:[{image:"nginx:1.16.0",imagePullPolicy:"IfNotPresent",livenessProbe:{failureThreshold:3,httpGet:{path:"/",port:"http",scheme:"HTTP"},periodSeconds:10,successThreshold:1,timeoutSeconds:1},name:"demo",ports:[{containerPort:80,name:"http",protocol:"TCP"}],readinessProbe:{failureThreshold:3,httpGet:{path:"/",port:"http",scheme:"HTTP"},periodSeconds:10,successThreshold:1,timeoutSeconds:1}}],tolerations:[{effect:"NoExecute",key:"node.kubernetes.io/not-ready",operator:"Exists",tolerationSeconds:300},{effect:"NoExecute",key:"node.kubernetes.io/unreachable",operator:"Exists",tolerationSeconds:300}]}};function ge({open:s,onOpenChange:n,currentRow:a}){const i=!!a,[l,t]=g.useState(""),[m,r]=g.useState(""),[c,f]=g.useState(!1);g.useEffect(()=>{a!=null&&a.raw&&t(JSON.stringify(a.raw,null,2)),r(JSON.stringify(ra,null,2))},[a]);const v=()=>{try{if(!(a!=null&&a.namespace)||!(a!=null&&a.name)){y({title:"更新失败",description:"缺少必要的Pod信息",variant:"destructive"});return}const x={group:"",version:"v1",resource:"pods",namespace:a.namespace,name:a.name,data:JSON.parse(l)};fetch("/api/gvr",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}).then(p=>{if(!p.ok)throw new Error("更新失败");return p.json()}).then(p=>{y({title:"更新成功",description:"Pod配置已更新"}),n(!1)}).catch(p=>{y({title:"更新失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}},j=()=>{try{const x=JSON.parse(m);x.metadata.name===""&&y({title:"缺少必要条件",description:"metdata.name 不能为空"});const p={group:"",version:"v1",resource:"pods",namespace:x.metadata.namespace===""?"default":x.metadata.namespace,name:x.metadata.name,data:x};fetch("/api/gvr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).then(N=>{if(!N.ok)throw new Error("新增失败");return N.json()}).then(N=>{y({title:"新增成功",description:"Pod配置已新增"}),n(!1)}).catch(N=>{y({title:"新增失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsx(ts,{open:s,onOpenChange:x=>{n(x)},children:e.jsxs(ds,{side:"right",className:"w-[50%] sm:max-w-[90%] flex flex-col overflow-y-auto",children:[e.jsxs(rs,{className:"text-left",children:[e.jsxs(cs,{children:[i?"更新":"创建"," Pod"]}),e.jsx(os,{children:i?"更新Pod配置信息":"创建新的Pod配置"})]}),i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(u,{variant:"outline",onClick:()=>f(!c),children:c?"切换到视图模式":"切换到编辑模式"})}),c?e.jsx(R,{value:l,onChange:x=>t(x.target.value),className:"flex-1 font-mono resize-none",placeholder:"请输入JSON数据..."}):e.jsx(Fe,{src:(a==null?void 0:a.raw)||{},enableClipboard:!0,displayDataTypes:!1,name:!1})]}):e.jsx(R,{value:m,onChange:x=>{r(x.target.value)},className:"flex-1 font-mono resize-none",placeholder:"请输入Pod配置..."}),e.jsxs(ms,{className:"gap-2 mt-4",children:[e.jsx(xs,{asChild:!0,children:e.jsx(u,{variant:"outline",children:"关闭"})}),i?c&&e.jsx(u,{form:"tasks-form",onClick:v,children:"更新配置"}):e.jsx(u,{form:"tasks-form",onClick:j,children:"新建"})]})]})})}function ca({open:s,onOpenChange:n,podName:a,namespace:i,containerName:l}){const t=`/ws/logs/html/${i}/${a}/${l}`;return e.jsx(se,{open:s,onOpenChange:n,children:e.jsx(ae,{className:"h-[80vh] mt-0",children:e.jsx("div",{className:"w-full h-full",children:e.jsx("iframe",{src:t,className:"w-full h-full rounded-md border",style:{minHeight:"500px"}})})})})}function oa({open:s,onOpenChange:n,podName:a,namespace:i,containerName:l}){const t=`/ws/ssh/html/${i}/${a}/${l}`;return e.jsx(se,{open:s,onOpenChange:n,children:e.jsx(ae,{className:"h-[80vh] mt-0",children:e.jsx("div",{className:"w-full h-full",children:e.jsx("iframe",{src:t,className:"w-full h-full rounded-md",style:{minHeight:"500px"}})})})})}function ma(){return e.jsxs("div",{className:"*:data-[slot=card]:from-primary/5 *:data-[slot=card]:to-card dark:*:data-[slot=card]:bg-card grid grid-cols-1 gap-4 px-4 *:data-[slot=card]:bg-gradient-to-t *:data-[slot=card]:shadow-xs lg:px-6 @xl/main:grid-cols-2 @5xl/main:grid-cols-4",children:[e.jsxs(b,{className:"@container/card",children:[e.jsxs(S,{children:[e.jsx(D,{children:"Total Revenue"}),e.jsx(C,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"$1,250.00"}),e.jsx(G,{children:e.jsxs(A,{variant:"outline",children:[e.jsx(H,{}),"+12.5%"]})})]}),e.jsxs(U,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Trending up this month ",e.jsx(H,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Visitors for the last 6 months"})]})]}),e.jsxs(b,{className:"@container/card",children:[e.jsxs(S,{children:[e.jsx(D,{children:"New Customers"}),e.jsx(C,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"1,234"}),e.jsx(G,{children:e.jsxs(A,{variant:"outline",children:[e.jsx(fe,{}),"-20%"]})})]}),e.jsxs(U,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Down 20% this period ",e.jsx(fe,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Acquisition needs attention"})]})]}),e.jsxs(b,{className:"@container/card",children:[e.jsxs(S,{children:[e.jsx(D,{children:"Active Accounts"}),e.jsx(C,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"45,678"}),e.jsx(G,{children:e.jsxs(A,{variant:"outline",children:[e.jsx(H,{}),"+12.5%"]})})]}),e.jsxs(U,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Strong user retention ",e.jsx(H,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Engagement exceed targets"})]})]}),e.jsxs(b,{className:"@container/card",children:[e.jsxs(S,{children:[e.jsx(D,{children:"Growth Rate"}),e.jsx(C,{className:"text-2xl font-semibold tabular-nums @[250px]/card:text-3xl",children:"4.5%"}),e.jsx(G,{children:e.jsxs(A,{variant:"outline",children:[e.jsx(H,{}),"+4.5%"]})})]}),e.jsxs(U,{className:"flex-col items-start gap-1.5 text-sm",children:[e.jsxs("div",{className:"line-clamp-1 flex gap-2 font-medium",children:["Steady performance increase ",e.jsx(H,{className:"size-4"})]}),e.jsx("div",{className:"text-muted-foreground",children:"Meets growth projections"})]})]})]})}const ue=s=>s.running?"Running":s.waiting?"Waiting":s.terminated?"Terminated":s.successed?"Successed":s.failed?"Failed":s.pending?"Pending":"Unknown";function xa({currentRow:s}){const{setOpen:n,setCurrentRow:a,setContainerName:i}=Q(),l=g.useMemo(()=>{if(!s||!s.crd||!s.crd.status)return[];const t=s.crd.status.containerStatuses||[],m=s.crd.status.initContainerStatuses||[];return m.forEach(c=>{c.initContainer=!0}),[...t,...m].map((c,f)=>e.jsxs(h,{children:[e.jsx(d,{children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(A,{variant:"outline",className:K("capitalize",na.get(ue(c.state))),children:ue(c.state)})})}),e.jsx(d,{className:"font-medium",children:c.name}),e.jsx(d,{className:"font-medium",children:c.ready?e.jsx(L,{className:"h-4 w-4 text-green-500"}):e.jsx(w,{className:"h-4 w-4 text-gray-400"})}),e.jsx(d,{className:"font-medium",children:c.image}),e.jsx(d,{className:"font-medium",children:c.initContainer?e.jsx(L,{className:"h-4 w-4 text-green-500"}):e.jsx(w,{className:"h-4 w-4 text-gray-400"})}),e.jsx(d,{className:"font-medium",children:c.restartCount}),e.jsx(d,{className:"font-medium",children:c.started?"True":"False"}),e.jsx(d,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{variant:"secondary",size:"sm",onClick:()=>{a(s),i(c.name),n("terminal")},children:"日志"}),e.jsx(u,{variant:"secondary",size:"sm",onClick:()=>{a(s),i(c.name),n("ssh")},children:"SSH"})]})})]},`${c.name}-${f}`))},[s]);return e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsx(C,{children:s==null?void 0:s.crd.metadata.name}),e.jsxs(D,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsx(T,{className:"space-y-2",children:e.jsxs(k,{children:[e.jsx(_s,{children:"容器详情"}),e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{className:"w-[100px]",children:"Status"}),e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Ready"}),e.jsx(o,{children:"Image"}),e.jsx(o,{children:"InitContainer"}),e.jsx(o,{children:"Restart"}),e.jsx(o,{children:"Started"}),e.jsx(o,{children:"操作"})]})}),e.jsx(O,{children:l})]})})]})}function ha({currentRow:s}){const n=g.useMemo(()=>!s||!s.crd||!s.crd.metadata.labels?[]:Object.entries(s.crd.metadata.labels).map(([a,i])=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:a}),e.jsx(d,{children:i})]},a)),[s]);return e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsx(C,{children:s==null?void 0:s.crd.metadata.name}),e.jsxs(D,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsx(T,{className:"space-y-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{className:"w-[50%]",children:"键"}),e.jsx(o,{className:"w-[50%]",children:"值"})]})}),e.jsx(O,{children:n})]})})]})}function ja({currentRow:s}){const n=g.useMemo(()=>!s||!s.crd||!s.crd.metadata.annotations?[]:Object.entries(s.crd.metadata.annotations).map(([a,i])=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:a}),e.jsx(d,{children:i})]},a)),[s]);return e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsx(C,{children:s==null?void 0:s.crd.metadata.name}),e.jsxs(D,{children:["命名空间：",s==null?void 0:s.crd.metadata.namespace]})]}),e.jsx(T,{className:"space-y-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{className:"w-[50%]",children:"键"}),e.jsx(o,{className:"w-[50%]",children:"值"})]})}),e.jsx(O,{children:n})]})})]})}function pa({currentRow:s}){const n=g.useMemo(()=>!s||!s.raw||!s.raw.status||!s.raw.status.conditions?[]:Object.entries(s.raw.status.conditions).map((a,i)=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:a[1].type}),e.jsx(d,{children:a[1].status==="True"?e.jsx(L,{className:"h-4 w-4 text-green-500"}):e.jsx(w,{className:"h-4 w-4 text-gray-400"})}),e.jsx(d,{children:a[1].lastTransitionTime})]},i)),[s]);return e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsx(C,{children:s==null?void 0:s.raw.metadata.name}),e.jsxs(D,{children:["命名空间：",s==null?void 0:s.raw.metadata.namespace]})]}),e.jsx(T,{className:"space-y-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{className:"w-[30%]",children:"Condition"}),e.jsx(o,{className:"w-[30%]",children:"Status"}),e.jsx(o,{className:"w-[40%]",children:"Timestamp"})]})}),e.jsx(O,{children:n})]})})]})}function fa({currentRow:s}){const n=g.useMemo(()=>!s||!s.raw||!s.raw.status?[]:Object.entries(s.raw.status).map(([a,i])=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:a}),e.jsx(d,{children:JSON.stringify(i)})]},a)),[s]);return e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsx(C,{children:s==null?void 0:s.raw.metadata.name}),e.jsxs(D,{children:["命名空间：",s==null?void 0:s.raw.metadata.namespace]})]}),e.jsx(T,{className:"space-y-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{className:"w-[100px]",children:"属性"}),e.jsx(o,{children:"值"})]})}),e.jsxs(O,{children:[s&&Object.entries(s.raw.metadata).map(([a,i])=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:a}),e.jsx(d,{children:JSON.stringify(i)})]},a)),n,s&&Object.entries(s.raw.spec).map(([a,i])=>a!=="containers"&&e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:a}),e.jsx(d,{children:JSON.stringify(i)})]},a))]})]})})]}),e.jsxs(b,{className:"mt-4",children:[e.jsxs(S,{children:[e.jsx(C,{children:"Container信息"}),e.jsx(D,{children:"Container原始信息展示"})]}),e.jsx(T,{className:"space-y-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{className:"w-[100px]",children:"属性"}),e.jsx(o,{className:"w-[auto]",children:"值"})]})}),e.jsx(O,{children:s&&s.raw.spec.containers.map((a,i)=>Object.entries(a).map(([l,t])=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:l}),e.jsx(d,{children:e.jsx(Se,{children:e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx("div",{className:"whitespace-pre-wrap break-all",children:JSON.stringify(t)})}),e.jsx(Te,{className:"whitespace-pre-wrap break-all",children:JSON.stringify(t)})]})})})]},`${i}-${l}`)))})]})})]})]})}const ga=s=>s.emptyDir?"emptyDir":s.persistentVolumeClaim?"persistenVolumeClaim":s.configMap?"configMap":s.secret?"secret":s.projected?"projected":"Unknown";function ua({currentRow:s}){var i;const n=g.useMemo(()=>!s||!s.raw||!s.raw.metadata.ownerReferences?[]:Object.entries(s.raw.metadata.ownerReferences).map((l,t)=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:l[1].name}),e.jsx(d,{className:"font-medium",children:l[1].kind}),e.jsx(d,{children:l[1].controller?e.jsx(L,{className:"h-4 w-4 text-green-500"}):e.jsx(w,{className:"h-4 w-4 text-gray-400"})}),e.jsx(d,{children:l[1].blockOwnerDeletion?e.jsx(L,{className:"h-4 w-4 text-green-500"}):e.jsx(w,{className:"h-4 w-4 text-gray-400"})})]},t)),[s]),a=g.useMemo(()=>!s||!s.raw||!s.raw.spec.volumes?[]:Object.entries(s.raw.spec.volumes).map((l,t)=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:l[1].name}),e.jsx(d,{className:"font-medium",children:ga(l[1])}),e.jsx(d,{className:"font-medium",children:JSON.stringify(l[1],null,2)})]},t)),[s]);return e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsxs(C,{children:["关联References ",(i=s==null?void 0:s.raw.metadata.ownerReferences)==null?void 0:i.length]}),e.jsx(D,{children:"OwnerReferences"})]}),e.jsx(T,{className:"space-y-2",children:(s==null?void 0:s.raw.metadata.ownerReferences)&&e.jsx("div",{className:"mb-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Kind"}),e.jsx(o,{children:"Controller"}),e.jsx(o,{children:"是否集联删除"})]})}),e.jsx(O,{children:n})]})})})]}),e.jsxs(b,{className:"mt-4",children:[e.jsxs(S,{children:[e.jsxs(C,{children:["引用资源 ",s==null?void 0:s.raw.spec.volumes.length]}),e.jsx(D,{children:"磁盘卷配置"})]}),e.jsx(T,{className:"space-y-2",children:(s==null?void 0:s.raw.spec.volumes)&&e.jsx("div",{className:"mb-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Kind"}),e.jsx(o,{children:"Detail"})]})}),e.jsx(O,{children:a})]})})})]}),e.jsx(fa,{currentRow:s})]})}function Na({currentRow:s}){const n=g.useMemo(()=>{if(!s||!s.raw||!s.raw.spec.affinity)return[];const i=s.raw.spec.affinity,l=[];return i.nodeAffinity&&(i.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution&&l.push(e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:"节点亲和性"}),e.jsx(d,{className:"font-medium",children:"硬亲和性"}),e.jsx(d,{children:JSON.stringify(i.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution,null,2)})]},"node-affinity-required")),i.nodeAffinity.preferredDuringSchedulingIgnoredDuringExecution&&l.push(e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:"节点亲和性"}),e.jsx(d,{className:"font-medium",children:"软亲和性"}),e.jsx(d,{children:JSON.stringify(i.nodeAffinity.preferredDuringSchedulingIgnoredDuringExecution,null,2)})]},"node-affinity-preferred"))),i.podAffinity&&(i.podAffinity.requiredDuringSchedulingIgnoredDuringExecution&&l.push(e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:"Pod亲和性"}),e.jsx(d,{className:"font-medium",children:"硬亲和性"}),e.jsx(d,{children:JSON.stringify(i.podAffinity.requiredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-affinity-required")),i.podAffinity.preferredDuringSchedulingIgnoredDuringExecution&&l.push(e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:"Pod亲和性"}),e.jsx(d,{className:"font-medium",children:"软亲和性"}),e.jsx(d,{children:JSON.stringify(i.podAffinity.preferredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-affinity-preferred"))),i.podAntiAffinity&&(i.podAntiAffinity.requiredDuringSchedulingIgnoredDuringExecution&&l.push(e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:"Pod反亲和性"}),e.jsx(d,{className:"font-medium",children:"硬反亲和性"}),e.jsx(d,{children:JSON.stringify(i.podAntiAffinity.requiredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-anti-affinity-required")),i.podAntiAffinity.preferredDuringSchedulingIgnoredDuringExecution&&l.push(e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:"Pod反亲和性"}),e.jsx(d,{className:"font-medium",children:"软反亲和性"}),e.jsx(d,{children:JSON.stringify(i.podAntiAffinity.preferredDuringSchedulingIgnoredDuringExecution,null,2)})]},"pod-anti-affinity-preferred"))),l},[s]),a=g.useMemo(()=>!s||!s.raw||!s.raw.spec.tolerations?[]:s.raw.spec.tolerations.map((i,l)=>e.jsxs(h,{children:[e.jsx(d,{className:"font-medium",children:i.key||"-"}),e.jsx(d,{className:"font-medium",children:i.operator||"-"}),e.jsx(d,{className:"font-medium",children:i.value||"-"}),e.jsx(d,{className:"font-medium",children:i.effect||"-"}),e.jsx(d,{className:"font-medium",children:i.tolerationSeconds?i.tolerationSeconds:"无限期"})]},l)),[s]);return e.jsxs(e.Fragment,{children:[(s==null?void 0:s.raw.spec.affinity)&&e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsx(C,{children:s==null?void 0:s.raw.metadata.name}),e.jsxs(D,{children:["命名空间：",s==null?void 0:s.raw.metadata.namespace]})]}),e.jsx(T,{className:"space-y-2",children:e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-lg text-left font-semibold",children:"亲和性配置"}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{children:"类型"}),e.jsx(o,{children:"亲和性类型"}),e.jsx(o,{children:"配置详情"})]})}),e.jsx(O,{children:n})]})]})})]}),e.jsxs(b,{className:"mt-4",children:[e.jsxs(S,{children:[e.jsx(C,{children:s==null?void 0:s.raw.metadata.name}),e.jsxs(D,{children:["命名空间：",s==null?void 0:s.raw.metadata.namespace]})]}),e.jsx(T,{className:"space-y-2",children:(s==null?void 0:s.raw.spec.tolerations)&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("h3",{className:"text-lg text-left font-semibold",children:["容忍度配置 ",s==null?void 0:s.raw.spec.tolerations.length]}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{children:"Key"}),e.jsx(o,{children:"Operator"}),e.jsx(o,{children:"Value"}),e.jsx(o,{children:"Effect"}),e.jsx(o,{children:"容忍时间(秒)"})]})}),e.jsx(O,{children:a})]})]})})]})]})}function va({currentRow:s}){const[n,a]=g.useState([]),i=async()=>{var r,c,f,v;try{const j=await ke.post("/api/gvr/list",{group:"",version:"v1",resource:"events",listoptions:{fieldSelector:`involvedObject.name=${(c=(r=s==null?void 0:s.raw)==null?void 0:r.metadata)==null?void 0:c.name},involvedObject.namespace=${(v=(f=s==null?void 0:s.raw)==null?void 0:f.metadata)==null?void 0:v.namespace}`,limit:1e3,sortBy:"lastTimestamp",sortOrder:"desc"}});a(j.data.items)}catch(j){y({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(j,null,2)})})})}},l=r=>{const f=Date.now()-r,v=24*3600*1e3,j=3600*1e3,x=60*1e3,p=Math.floor(f/v),N=f%v,J=Math.floor(N/j),F=N%j,V=Math.floor(F/x),E=F%x,$=Math.round(E/1e3);return{days:p,hours:J,minutes:V,seconds:$}},t=(r,c,f,v)=>{let j="";return r>0&&(j+=`${r}d `),c>0&&(j+=`${c}h `),f>0&&(j+=`${f}m `),v>0&&(j+=`${v}s`),j},m=r=>{const c=new Date(r).getTime(),{days:f,hours:v,minutes:j,seconds:x}=l(c);return t(f,v,j,x)};return g.useEffect(()=>{i()},[]),e.jsxs(b,{children:[n.length>0&&e.jsx(S,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(C,{children:n[0].involvedObject.name}),e.jsxs(D,{children:["命名空间：",n[0].involvedObject.namespace]})]}),e.jsxs(u,{variant:"outline",size:"sm",onClick:i,children:[e.jsx(Gs,{className:"h-4 w-4 mr-2"}),"刷新"]})]})}),e.jsx(T,{className:"space-y-2",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(h,{children:[e.jsx(o,{className:"w-[40px]",children:"Kind"}),e.jsx(o,{className:"w-[100px]",children:"Reason"}),e.jsx(o,{className:"w-[500px]",children:"Message"}),e.jsx(o,{className:"w-[80px]",children:"Source"}),e.jsx(o,{className:"w-[80px]",children:"Type"}),e.jsx(o,{className:"w-[80px]",children:"Age"})]})}),e.jsx(O,{children:n.length>0&&n.map((r,c)=>e.jsxs(h,{children:[e.jsx(d,{children:r.involvedObject.kind}),e.jsx(d,{children:r.reason}),e.jsx(d,{className:"whitespace-pre-wrap break-all max-w-[300px]",children:r.message}),e.jsx(d,{children:r.source.component}),e.jsx(d,{children:r.type}),e.jsx(d,{children:e.jsx("div",{className:"w-fit",children:m(r.lastTimestamp)})})]},c))})]})})]})}function ya({open:s,onOpenChange:n,currentRow:a}){var c,f,v,j,x,p,N,J,F,V,E,$,B;const[i,l]=g.useState(!1),[t,m]=g.useState("");g.useEffect(()=>{a!=null&&a.crd&&m(JSON.stringify(a.crd,null,2))},[a]);const r=()=>{var z,ie,ne,le;try{const te={group:"",version:"v1",resource:"pods",namespace:(ie=(z=a==null?void 0:a.crd)==null?void 0:z.metadata)==null?void 0:ie.namespace,name:(le=(ne=a==null?void 0:a.crd)==null?void 0:ne.metadata)==null?void 0:le.name,data:i?JSON.parse(t):a==null?void 0:a.crd};fetch("/api/gvr",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(te)}).then(X=>X.json()).then(X=>{y({title:"更新成功",description:"Pod配置已更新"})}).catch(X=>{y({title:"更新失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsx(se,{open:s,onOpenChange:n,children:e.jsx(ae,{children:e.jsxs(hs,{defaultValue:"container",className:"w-full",children:[e.jsxs(js,{className:"grid w-full grid-cols-9 gap-2",children:[e.jsxs(I,{value:"container",children:["容器",e.jsx(Y,{className:"h-5 w-5 ml-1",children:e.jsx(W,{className:"text-xs",children:((v=(f=(c=a==null?void 0:a.crd)==null?void 0:c.status)==null?void 0:f.containerStatuses)==null?void 0:v.length)||0+((p=(x=(j=a==null?void 0:a.crd)==null?void 0:j.status)==null?void 0:x.initContainerStatuses)==null?void 0:p.length)||0})})]}),e.jsxs(I,{value:"label",children:["标签",e.jsx(Y,{className:"h-5 w-5 ml-1",children:e.jsx(W,{className:"text-xs",children:(J=(N=a==null?void 0:a.crd)==null?void 0:N.metadata)!=null&&J.labels?Object.keys(a.crd.metadata.labels).length:0})})]}),e.jsxs(I,{value:"annotation",children:["注释",e.jsx(Y,{className:"h-5 w-5 ml-1",children:e.jsx(W,{className:"text-xs",children:(V=(F=a==null?void 0:a.crd)==null?void 0:F.metadata)!=null&&V.annotations?Object.keys(a.crd.metadata.annotations).length:0})})]}),e.jsxs(I,{value:"status",children:["状态",e.jsx(Y,{className:"h-5 w-5 ml-1",children:e.jsx(W,{className:"text-xs",children:($=(E=a==null?void 0:a.crd)==null?void 0:E.metadata)!=null&&$.annotations?Object.keys((B=a.crd.status)==null?void 0:B.conditions).length:0})})]}),e.jsx(I,{value:"diaodu",children:"调度"}),e.jsx(I,{value:"event",children:"事件"}),e.jsx(I,{value:"relative",children:"相关资源"}),e.jsx(I,{value:"monitor",children:"监控"}),e.jsx(I,{value:"jsondata",children:"查看或编辑"})]}),e.jsx(M,{value:"container",className:"h-[80vh] overflow-y-auto",children:e.jsx(xa,{currentRow:a})}),e.jsx(M,{value:"label",className:"h-[80vh] overflow-y-auto",children:e.jsx(ha,{currentRow:a})}),e.jsx(M,{value:"annotation",className:"h-[80vh] overflow-y-auto",children:e.jsx(ja,{currentRow:a})}),e.jsx(M,{value:"status",className:"h-[80vh] overflow-y-auto",children:e.jsx(pa,{currentRow:a})}),e.jsx(M,{value:"relative",className:"h-[80vh] overflow-y-auto",children:e.jsx(ua,{currentRow:a})}),e.jsx(M,{value:"diaodu",className:"h-[80vh] overflow-y-auto",children:e.jsx(Na,{currentRow:a})}),e.jsx(M,{value:"event",className:"h-[80vh] overflow-y-auto",children:e.jsx(va,{currentRow:a})}),e.jsx(M,{value:"monitor",className:"h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"h-[80vh] grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"rounded-md",children:e.jsx(b,{className:"h-full border rounded-md overflow-y-auto",children:e.jsx(da,{})})}),e.jsx("div",{className:"rounded-md",children:e.jsx(ma,{})}),e.jsx("div",{className:"rounded-md h-full overflow-y-auto overflow-x-auto bg-gray-800 border border-gray-600",children:e.jsx("pre",{className:"text-white whitespace-pre-wrap h-full p-4",children:e.jsx("code",{children:a?JSON.stringify(a.crd,null,2):"currentRow is undefined or null"})})})]})}),e.jsx(M,{value:"jsondata",className:"h-[80vh] overflow-y-auto",children:e.jsxs(b,{children:[e.jsxs(S,{children:[e.jsx(C,{children:a==null?void 0:a.crd.metadata.name}),e.jsxs(D,{children:["命名空间：",a==null?void 0:a.crd.metadata.namespace]})]}),e.jsxs(T,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-end mb-4",children:[i&&e.jsx(u,{variant:"ghost",onClick:r,children:"更新"}),e.jsx(u,{variant:"outline",onClick:()=>l(!i),children:i?"切换到视图模式":"切换到编辑模式"})]}),i?e.jsx(R,{value:t,onChange:z=>m(z.target.value),className:"min-h-[500px] font-mono",placeholder:"请输入JSON数据..."}):e.jsx(Fe,{src:(a==null?void 0:a.crd)||{},enableClipboard:!0,displayDataTypes:!1,name:!1})]})]})})]})})})}function ba(){const{open:s,setOpen:n,currentRow:a,setCurrentRow:i,containerName:l,setContainerName:t}=Q(),m=()=>{try{if(!(a!=null&&a.namespace)||!(a!=null&&a.name)){y({title:"更新失败",description:"缺少必要的Pod信息",variant:"destructive"});return}const r={group:"",version:"v1",resource:"pods",namespace:a==null?void 0:a.namespace,name:a==null?void 0:a.name};fetch("/api/gvr",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(c=>{if(!c.ok)throw new Error("刪除失败");return c.json()}).then(c=>{y({title:"刪除成功",description:"Pod配置已刪除"})}).catch(c=>{y({title:"刪除失败",description:"请检查网络连接或联系管理员",variant:"destructive"})})}catch{y({title:"JSON格式错误",description:"请检查JSON格式是否正确",variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{open:s==="create",onOpenChange:()=>n("create")},"task-create"),e.jsx(ia,{open:s==="import",onOpenChange:()=>n("import")},"tasks-import"),a&&e.jsxs(e.Fragment,{children:[e.jsx(ge,{open:s==="update",onOpenChange:()=>{n("update"),setTimeout(()=>{i(null)},500)},currentRow:a},`task-update-${a.id}`),e.jsx(ca,{open:s==="terminal",onOpenChange:()=>{n(null),t(void 0),setTimeout(()=>{i(null)},500)},podName:a.name,namespace:a.namespace,containerName:l},`pod-terminal-${a.name}`),e.jsx(ya,{open:s==="detail",onOpenChange:()=>{n(null),setTimeout(()=>{i(null)},500)},currentRow:a},`pod-detail-${a.name}`),e.jsx(oa,{open:s==="ssh",onOpenChange:()=>{n(null),t(void 0),setTimeout(()=>{i(null)},500)},podName:a.name,namespace:a.namespace,containerName:l},`pod-ssh-${a.name}`),e.jsx(Fs,{destructive:!0,open:s==="delete",onOpenChange:()=>{n("delete"),setTimeout(()=>{i(null)},500)},handleConfirm:()=>{n(null),setTimeout(()=>{i(null)},500),m()},name:a.name,namespace:a.namespace,className:"max-w-md",title:`Delete Pod: ${a.namespace}/${a.name} ?`,desc:e.jsxs(e.Fragment,{children:["You are about to delete a Pod with the Name"," ",e.jsxs("strong",{children:[a.namespace,"/",a.name]}),". ",e.jsx("br",{}),"This action cannot be undone."]}),confirmText:"Delete"},"task-delete")]})]})}function Sa(){const[s,n]=g.useState([]),a=async()=>{try{const i=await ke.post("/api/gvr/list",{group:"apps",version:"v1",resource:"deployments",fast:!0});console.log("请求接口成功:",i.data),n(i.data)}catch(i){y({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(i,null,2)})})})}};return g.useEffect(()=>{a()},[]),e.jsxs(Ys,{children:[e.jsxs(ps,{fixed:!0,children:[e.jsx(fs,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(gs,{}),e.jsx(us,{})]})]}),e.jsx(Ns,{children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-x-4 space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Deployments"}),e.jsx("p",{className:"text-muted-foreground",children:"Deployments是Kubernetes中用于管理应用程序的资源，确保在任何给定时间都有指定数量的Pods在运行。"})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0 mr-[1px]",children:e.jsx(sa,{data:s,columns:Ws,fetchData:a})})]})}),e.jsx(ba,{})]})}const za=vs("/_authenticated/deployments/")({component:Sa});export{za as Route};
