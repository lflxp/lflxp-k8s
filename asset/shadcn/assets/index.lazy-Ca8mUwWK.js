import{j as e,B as x,b2 as j,r as d,Y as f,H as y,p as N,T as b,q as v,M as w,a5 as R,c as T}from"./index-DIKYiZQ1.js";import{T as m,d as h,b as c,e as i,u as S,g as C,a as I,c as k,f as p}from"./table-DwGayh7i.js";import{r as V}from"./request-ColAWihI.js";function A({columns:s,data:r}){var a;if(!s||!r)return e.jsx("div",{className:"rounded-md border",children:e.jsx(m,{children:e.jsx(h,{children:e.jsx(c,{children:e.jsx(i,{colSpan:(s==null?void 0:s.length)||0,className:"h-24 text-center",children:"没有数据"})})})})});const t=S({data:r,columns:s,getCoreRowModel:C()});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(m,{children:[e.jsx(I,{children:t.getHeaderGroups().map(o=>e.jsx(c,{children:o.headers.map(l=>e.jsx(k,{children:l.isPlaceholder?null:p(l.column.columnDef.header,l.getContext())},l.id))},o.id))}),e.jsx(h,{children:(a=t.getRowModel().rows)!=null&&a.length?t.getRowModel().rows.map(o=>e.jsx(c,{"data-state":o.getIsSelected()&&"selected",children:o.getVisibleCells().map(l=>e.jsx(i,{children:p(l.column.columnDef.cell,l.getContext())},l.id))},o.id)):e.jsx(c,{children:e.jsx(i,{colSpan:s.length,className:"h-24 text-center",children:"没有数据"})})})]})})}const D=[{id:"name",header:"节点名称",cell:({row:s})=>s.original.metadata.name},{id:"status",header:"状态",cell:({row:s})=>{var u;const r=((u=s.original.status)==null?void 0:u.conditions)||[],t=r.find(n=>n.type==="Ready"),a=r.filter(n=>n.type!=="Ready").every(n=>n.status==="False"),o=t&&t.status==="True"||a?"Active":"警告",l=t&&t.status==="True"||a?"green":"red",g=r.filter(n=>n.type==="Ready"&&n.status==="False"||n.type!=="Ready"&&n.status==="True").map(n=>n.message).join(`
`);return e.jsx("span",{style:{color:l},title:g,children:o})}},{id:"Kubernetes",header:"Kubernetes",cell:({row:s})=>{var t,a;return((a=(t=s.original.status)==null?void 0:t.nodeInfo)==null?void 0:a.kubeletVersion)||"N/A"}},{id:"OS",header:"OS",cell:({row:s})=>{var t,a;return((a=(t=s.original.status)==null?void 0:t.nodeInfo)==null?void 0:a.osImage)||"N/A"}},{accessorKey:"cpuUsage",header:"CPU使用率",cell:({row:s})=>"N/A"},{accessorKey:"memoryUsage",header:"内存使用率"},{id:"kernelVersion",header:"内核版本",cell:({row:s})=>{var t,a;return((a=(t=s.original.status)==null?void 0:t.nodeInfo)==null?void 0:a.kernelVersion)||"N/A"}},{id:"arch",header:"架构",cell:({row:s})=>{var t,a;return((a=(t=s.original.status)==null?void 0:t.nodeInfo)==null?void 0:a.architecture)||"N/A"}},{accessorKey:"操作系统",header:"operatingSystem",cell:({row:s})=>{var t,a;return((a=(t=s.original.status)==null?void 0:t.nodeInfo)==null?void 0:a.operatingSystem)||"N/A"}}];function K({columns:s,data:r}){return e.jsx(A,{columns:s,data:r})}function M(){return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(x,{children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"添加节点"]}),e.jsx(x,{variant:"outline",children:"刷新"})]})}const P=d.createContext(null);function H({children:s}){const[r,t]=f.useState(null);return e.jsx(P.Provider,{value:{metrics:r,setMetrics:t},children:s})}function B(){const[s,r]=d.useState([]),t=async()=>{try{const a=await V.post("/api/gvr/list",{group:"",version:"v1",resource:"nodes",namespace:""});console.log("请求接口成功:",a.data.items),r(a.data.items)}catch(a){R({title:"请求接口出错",description:e.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:e.jsx("code",{className:"text-white",children:JSON.stringify(a,null,2)})})})}};return d.useEffect(()=>{t()},[]),e.jsxs(H,{children:[e.jsxs(y,{fixed:!0,children:[e.jsx(N,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(b,{}),e.jsx(v,{})]})]}),e.jsxs(w,{children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-x-4 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Kubernetes Nodes"}),e.jsx("p",{className:"text-muted-foreground",children:"查看和管理您的Kubernetes集群节点信息"})]}),e.jsx(M,{})]}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(K,{data:s,columns:D})})]})]})}const U=T("/_authenticated/nodes/")({component:B});export{U as Route};
