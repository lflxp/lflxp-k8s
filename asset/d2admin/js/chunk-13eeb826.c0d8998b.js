(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13eeb826"],{"0706":function(module,exports){var indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var a=0;a<t.length;a++)if(t[a]===e)return a;return-1},Object_keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var a in t)e.push(a);return e},forEach=function(t,e){if(t.forEach)return t.forEach(e);for(var a=0;a<t.length;a++)e(t[a],a,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,e,a){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:a})}}catch(t){return function(t,e,a){t[e]=a}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var a=e.contentWindow,n=a.eval,s=a.execScript;!n&&s&&(s.call(a,"null"),n=a.eval),forEach(Object_keys(t),(function(e){a[e]=t[e]})),forEach(globals,(function(e){t[e]&&(a[e]=t[e])}));var o=Object_keys(a),r=n.call(a,this.code);return forEach(Object_keys(a),(function(e){(e in t||-1===indexOf(o,e))&&(t[e]=a[e])})),forEach(globals,(function(e){e in t||defineProp(t,e,a[e])})),document.body.removeChild(e),r},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var e=Script.createContext(t),a=this.runInContext(e);return t&&forEach(Object_keys(e),(function(a){t[a]=e[a]})),a},forEach(Object_keys(Script.prototype),(function(t){exports[t]=Script[t]=function(e){var a=Script(e);return a[t].apply(a,[].slice.call(arguments,1))}})),exports.isContext=function(t){return t instanceof Context},exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var e=new Context;return"object"===typeof t&&forEach(Object_keys(t),(function(a){e[a]=t[a]})),e}},"9bee":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("d2-container",[a("el-dialog",{attrs:{title:t.kinds,center:"true",visible:t.dialogVisible,width:"90%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("d2-highlight",{staticStyle:{"margin-bottom":"10px"},attrs:{code:t.jsonDataStr}}),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"Containers",name:"first"}},[a("el-table",{attrs:{data:t.containers,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",sortable:"",label:"Status"},scopedSlots:t._u([{key:"default",fn:function(e){return[void 0!==e.row.state.running?a("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("Running")]):void 0!==e.row.state.terminated?a("el-tag",{attrs:{size:"mini",type:"warning"}},[t._v("Terminated")]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[t._v(t._s(e.row.state))])]}}])}),a("el-table-column",{attrs:{label:"Ready",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[t.row.ready?a("div",[a("i",{staticClass:"el-icon-check"})]):a("div",[a("i",{staticClass:"el-icon-close"})])]}}])}),a("el-table-column",{attrs:{label:"Name"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.name)+" ")]}}])}),a("el-table-column",{attrs:{label:"Image",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.image))])]}}])}),a("el-table-column",{attrs:{label:"InitContainer",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.init?a("div",[a("i",{staticClass:"el-icon-check",attrs:{type:"success"}})]):a("div",[t._v(" - ")])]}}])}),a("el-table-column",{attrs:{label:"Restart",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.restartCount)+" ")]}}])}),a("el-table-column",{attrs:{label:"Started"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.started?a("div",[a("i",{staticClass:"el-icon-check"})]):a("div",[t._v(" - ")])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.showLogsstatus(e.row.name)}}},[t._v("日志")]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.showsshstatus(e.row.name)}}},[t._v("SSH")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"Conditions",name:"Conditions"}},[t._v("Conditions")]),a("el-tab-pane",{attrs:{label:"相关资源",name:"相关资源"}},[t._v("相关资源")]),a("el-tab-pane",{attrs:{label:"YAML",name:"second"}},[a("vue-json-editor",{attrs:{showBtns:!0,mode:"tree",lang:"zh",expandedOnStart:!0},on:{"json-change":t.onJsonChange,"json-save":t.onJsonSave},model:{value:t.jsonData,callback:function(e){t.jsonData=e},expression:"jsonData"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确 定")])],1)],1),a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择Pods进行精确查询"},on:{change:t.changepods,clear:t.clears},model:{value:t.podValue,callback:function(e){t.podValue=e},expression:"podValue"}},t._l(t.list,(function(t){return a("el-option",{key:t.metadata.name,attrs:{label:t.metadata.name,value:t.metadata.name}})})),1),a("el-button",{on:{click:t.fetchData}},[t._v("刷新")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list.slice((t.currentPage-1)*t.pageSize,t.currentPage*t.pageSize),"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",sortable:"",label:"Status",prop:"status.phase",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return["Running"===e.row.status.phase?a("el-tag",{attrs:{size:"mini",type:"success"}},[t._v(t._s(e.row.status.phase))]):"Succeeded"===e.row.status.phase?a("el-tag",{attrs:{size:"mini",type:"warning"}},[t._v(t._s(e.row.status.phase))]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[t._v(t._s(e.row.status.phase))])]}}])}),a("el-table-column",{attrs:{label:"Name"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.openit(e.row)}}},[t._v(t._s(e.row.metadata.name))])]}}])}),a("el-table-column",{attrs:{label:"Image",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.spec.containers[0].image)+" "),e.row.spec.containers.length>1?a("div",[a("br"),a("el-button",{attrs:{type:"text"}},[t._v("+"+t._s(e.row.spec.containers.length)+" more")])],1):t._e()]}}])}),a("el-table-column",{attrs:{label:"Namespace",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.metadata.namespace))])]}}])}),a("el-table-column",{attrs:{label:"Ready",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(void 0===e.row.status.containerStatuses?"-":e.row.status.containerStatuses.map((function(t){return!0===t.ready?1:0})).reduce((function(t,e,a,n){return t+e})))+"/"+t._s(e.row.spec.containers.length))])]}}])}),a("el-table-column",{attrs:{label:"Restart",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(void 0===e.row.status.containerStatuses?"-":e.row.status.containerStatuses[0].restartCount)+" ")]}}])}),a("el-table-column",{attrs:{"class-name":"status-col",label:"IP",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:"primary",size:"mini"}},[t._v(t._s(e.row.status.podIP))])]}}])}),a("el-table-column",{attrs:{label:"Node",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.status.hostIP)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",prop:"metadata.creationTimestamp",sortable:"",label:"Age",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.timeFn(e.row.metadata.creationTimestamp)))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{clearable:"",placeholder:"容器日志"},on:{focus:function(a){return t.getC(e.row)},change:function(a){return t.showLogs2(e.row,t.podValue)}},model:{value:t.podValue,callback:function(e){t.podValue=e},expression:"podValue"}},t._l(t.currentNameList,(function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),1),a("el-select",{attrs:{clearable:"",placeholder:"SSH容器"},on:{change:function(a){return t.showssh(e.row,t.sshValue)}},model:{value:t.sshValue,callback:function(e){t.sshValue=e},expression:"sshValue"}},t._l(e.row.spec.containers,(function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),1),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.deletepod(e.row)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"block",staticStyle:{"margin-top":"15px"}},[a("el-pagination",{attrs:{align:"center","current-page":t.currentPage,"page-sizes":[1,5,10,20],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.list.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},s=[],o=a("ade3"),r=(a("b0c0"),a("159b"),a("ad8f")),i=a("45a3"),l=a("c276"),c=(a("0706"),{components:{vueJsonEditor:i["a"]},filters:{statusFilter:function(t){var e={published:"success",draft:"gray",deleted:"danger"};return e[t]}},data:function(){var t;return t={activeName:"first",list:null,listLoading:!0,kinds:"",dialogVisible:!1,jsonData:"",jsonDataStr:"",value:"",namespaces:"",podValue:"",currentList:"",currentPage:1,total:20,pageSize:10,namespace:""},Object(o["a"])(t,"podValue",""),Object(o["a"])(t,"sshValue",""),Object(o["a"])(t,"currentNameList",[]),Object(o["a"])(t,"containers",[]),Object(o["a"])(t,"selecetNs",""),Object(o["a"])(t,"selectName",""),t},created:function(){this.fetchData()},methods:{handleClick:function(t,e){console.log(t,e)},showLogs2:function(t,e){var a="/ws/logs/html/"+t.metadata.namespace+"/"+t.metadata.name+"/"+e;window.open(a,t.metadata.namespace+"-"+t.metadata.name,"height=600,width=1200,top=0,left=200,fullscreen=yes,scrollbars=0,location=no"),this.podValue=""},showLogsstatus:function(t){var e="/ws/logs/html/"+this.selecetNs+"/"+this.selectName+"/"+t;window.open(e,this.selecetNs+"-"+this.selectName,"height=600,width=1200,top=0,left=200,fullscreen=no,scrollbars=0,location=no")},showssh:function(t,e){var a="/ws/ssh/html/"+t.metadata.namespace+"/"+t.metadata.name+"/"+e;window.open(a,t.metadata.namespace+"-"+t.metadata.name,"height=600,width=1000,top=0,left=200,fullscreen=no,scrollbars=0,location=no"),this.sshValue=""},showsshstatus:function(t){var e="/ws/ssh/html/"+this.selecetNs+"/"+this.selectName+"/"+t;window.open(e,this.selecetNs+"-"+this.selectName,"height=600,width=1000,top=0,left=200,fullscreen=no,scrollbars=0,location=no"),this.sshValue=""},getC:function(t){var e=this;this.currentNameList=[],t.spec.containers.length>0&&t.spec.containers.forEach((function(t){e.currentNameList.push(t)})),t.spec.initContainers.length>0&&t.spec.initContainers.forEach((function(t){e.currentNameList.push(t)})),console.log(this.currentNameList)},handleSizeChange:function(t){console.log("每页 ".concat(t," 条")),this.currentPage=1,this.pageSize=t},handleCurrentChange:function(t){console.log("当前页: ".concat(t)),this.currentPage=t},getNs:function(){this.namespace=l["a"].cookies.get("namespace")},fetchData:function(){var t=this;this.listLoading=!0,this.getNs();var e={group:"",version:"v1",resource:"pods",namespace:this.namespace};Object(r["e"])(e).then((function(e){console.log("apiserver",e),t.list=e.data.items,t.total=t.list.length,t.listLoading=!1}))},changens:function(t){var e=this;this.listLoading=!0;var a={group:"",version:"v1",resource:"pods",namespace:t};Object(r["e"])(a).then((function(t){console.log("apiserver",t),e.list=t.data.items,e.total=e.list.length,e.listLoading=!1}))},deletepod:function(t){var e=this;this.listLoading=!0;var a={group:"",version:"v1",resource:"pods",namespace:t.metadata.namespace,name:t.metadata.name};Object(r["a"])(a).then((function(t){console.log("apidelete",t),e.listLoading=!1})),this.fetchData()},changepods:function(t){var e=this;this.podValue=t;var a=JSON.parse(JSON.stringify(this.list));this.currentList=a,this.list=[],this.currentList.forEach((function(a){a.metadata.name===t&&e.list.push(a)})),this.total=this.list.length},clears:function(){this.changens(this.value)},openit:function(t){var e=this;console.log(t),this.selecetNs=t.metadata.namespace,this.selectName=t.metadata.name,this.jsonData=t,this.jsonDataStr={"命名空间":t.metadata.namespace,"开始时间":t.metadata.creationTimestamp,"容器IP":t.status.podIP,"节点IP":t.status.hostIP,"标签":t.metadata.labels,"注释":t.metadata.annotations},this.jsonDataStr=JSON.stringify(this.jsonDataStr,null,2),this.containers=[],t.status.containerStatuses.length>0&&t.status.containerStatuses.forEach((function(t){e.containers.push(t)})),t.status.initContainerStatuses.length>0&&t.status.initContainerStatuses.forEach((function(t){t["init"]=!0,e.containers.push(t)})),this.kinds="["+t.kind+"] "+t.metadata.name,this.dialogVisible=!0},timeFn:function(t){var e=new Date,a=(t=new Date(t),e.getTime()-t),n=Math.floor(a/864e5),s=a%864e5,o=Math.floor(s/36e5),r=s%36e5,i=Math.floor(r/6e4),l=r%6e4,c=Math.round(l/1e3),u="";return 0!==n&&(u+=n+" 天 "),0!==o&&(u+=o+" 小时 "),0!==i&&(u+=i+" 分钟 "),0!==c&&(u+=c+" 秒"),u},onJsonChange:function(t){console.log("value: change",t)},onJsonSave:function(t){var e=this;console.log("value save:",t);var a={group:"",version:"v1",resource:"pods",namespace:t.metadata.namespace,name:t.metadata.name,data:t};Object(r["c"])(a).then((function(t){console.log("resp",t),e.fetchData(),e.dialogVisible=!1}))}}}),u=c,d=a("2877"),p=Object(d["a"])(u,n,s,!1,null,null,null);e["default"]=p.exports}}]);